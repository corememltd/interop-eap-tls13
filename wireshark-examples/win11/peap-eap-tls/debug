FreeRADIUS Version 3.0.26
Copyright (C) 1999-2021 The FreeRADIUS server project and contributors
There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE
You may redistribute copies of FreeRADIUS under the terms of the
GNU General Public License
For more information about these matters, see the file named COPYRIGHT
Starting - reading configuration files ...
including dictionary file /usr/share/freeradius/dictionary
including dictionary file /usr/share/freeradius/dictionary.dhcp
including dictionary file /usr/share/freeradius/dictionary.vqp
including dictionary file /etc/freeradius/dictionary
including configuration file /etc/freeradius/radiusd.conf
including configuration file /etc/freeradius/proxy.conf
including configuration file /etc/freeradius/clients.conf
including files in directory /etc/freeradius/mods-enabled/
including configuration file /etc/freeradius/mods-enabled/detail
including configuration file /etc/freeradius/mods-enabled/realm
including configuration file /etc/freeradius/mods-enabled/pap
including configuration file /etc/freeradius/mods-enabled/files
including configuration file /etc/freeradius/mods-enabled/always
including configuration file /etc/freeradius/mods-enabled/mschap
including configuration file /etc/freeradius/mods-enabled/eap-test
including files in directory /etc/freeradius/policy.d/
including configuration file /etc/freeradius/policy.d/test-files
including configuration file /etc/freeradius/policy.d/canonicalization
including configuration file /etc/freeradius/policy.d/accounting
including configuration file /etc/freeradius/policy.d/operator-name
including configuration file /etc/freeradius/policy.d/filter
including configuration file /etc/freeradius/policy.d/debug
including configuration file /etc/freeradius/policy.d/control
including configuration file /etc/freeradius/policy.d/moonshot-targeted-ids
including configuration file /etc/freeradius/policy.d/eap
including configuration file /etc/freeradius/policy.d/rfc7542
including configuration file /etc/freeradius/policy.d/cui
including configuration file /etc/freeradius/policy.d/abfab-tr
including configuration file /etc/freeradius/policy.d/dhcp
including files in directory /etc/freeradius/sites-enabled/
including configuration file /etc/freeradius/sites-enabled/eap-test-tunnel
including configuration file /etc/freeradius/sites-enabled/test
main {
 security {
 	user = "freerad"
 	group = "freerad"
 	allow_core_dumps = no
 }
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
}
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	postauth_client_lost = no
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debugger not attached
systemd watchdog is disabled
 # Creating Auth-Type = pap
 # Creating Auth-Type = mschap
 # Creating Auth-Type = eap-test
radiusd: #### Instantiating modules ####
 modules {
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "bangpath" from file /etc/freeradius/mods-enabled/realm
  realm bangpath {
  	format = "prefix"
  	delimiter = "!"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  	winbind_retry_with_normalised_username = no
  }
  # Loaded module rlm_eap
  # Loading module "eap-test" from file /etc/freeradius/mods-enabled/eap-test
  eap eap-test {
  	default_eap_type = "tls"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  instantiate {
  }
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "bangpath" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "eap-test" from file /etc/freeradius/mods-enabled/eap-test
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_pwd
   pwd {
   	group = 19
   	fragment_size = 1020
   	server_id = "theserver@example.com"
   	virtual_server = "eap-test-inner"
   	prep = 0
   	unhex = 1
   }
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	auto_chain = yes
   	check_crl = no
   	check_all_crl = no
   	ca_path_reload_interval = 0
   	cipher_list = "DEFAULT"
   	cipher_server_preference = no
   	reject_unknown_intermediate_ca = no
   	ecdh_curve = ""
   	tls_max_version = "1.3"
   	tls_min_version = "1.0"
   	tls13_enable = yes
    cache {
    	enable = no
    	lifetime = 24
    	max_entries = 255
    	persist_dir = "/var/log/freeradius/tlscache"
    }
    verify {
    	skip_if_ocsp_ok = no
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
tls: In order to use TLS 1.0 and/or TLS 1.1, you likely need to set: cipher_list = "DEFAULT@SECLEVEL=1"
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! Most supplicants do not support EAP-TLS with TLS 1.3
!! Please set tls_max_version = "1.2"
!! FreeRADIUS only supports TLS 1.3 for special builds of wpa_supplicant and Windows
!! This limitation is likely to change in late 2021.
!! If you are using this version of FreeRADIUS after 2021, you will probably need to upgrade
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = yes
   	virtual_server = "eap-test-inner"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! There is no standard for using TTLS with TLS 1.3
!! Please set tls_max_version = "1.2"
!! FreeRADIUS only supports TLS 1.3 for special builds of wpa_supplicant and Windows
!! This limitation is likely to change in late 2021.
!! If you are using this version of FreeRADIUS after 2021, you will probably need to upgrade
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = yes
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "eap-test-inner"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
Failed to find 'Auth-Type eap' section in virtual server eap-test-inner.  The server cannot proxy inner-tunnel EAP packets.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! There is no standard for using PEAP with TLS 1.3
!! Please set tls_max_version = "1.2"
!! FreeRADIUS only supports TLS 1.3 for special builds of wpa_supplicant and Windows
!! This limitation is likely to change in late 2021.
!! If you are using this version of FreeRADIUS after 2021, you will probably need to upgrade
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
   # Linked to sub-module rlm_eap_fast
   fast {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	virtual_server = "eap-test-inner"
   	cipher_list = "ALL:!EXPORT:!eNULL:!SSLv2"
   	require_client_cert = no
   	pac_lifetime = 604800
   	authority_identity = "1234"
   	pac_opaque_key = "0123456789abcdef0123456789ABCDEF"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   }
tls: Using cached TLS configuration from previous invocation
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! There is no standard for using EAP-FAST with TLS 1.3
!! Please set tls_max_version = "1.2"
!! FreeRADIUS only supports TLS 1.3 for special builds of wpa_supplicant and Windows
!! This limitation is likely to change in late 2021.
!! If you are using this version of FreeRADIUS after 2021, you will probably need to upgrade
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server eap-test-inner { # from file /etc/freeradius/sites-enabled/eap-test-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading post-auth {...}
} # server eap-test-inner
server test { # from file /etc/freeradius/sites-enabled/test
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading accounting {...}
} # server test
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
  	proto = "udp"
  client everyone_ipv6 {
  	ipv6addr = ::/0
  	require_message_authenticator = no
  	secret = <<< secret >>>
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
  }
  client everyone_ipv4 {
  	ipv4addr = 0.0.0.0/0
  	require_message_authenticator = no
  	secret = <<< secret >>>
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
  }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
  	proto = "tcp"
}
listen {
  	type = "auth"
  	ipv4addr = 0.0.0.0
  	port = 0
  	proto = "udp"
}
listen {
  	type = "auth"
  	ipv4addr = 0.0.0.0
  	port = 0
  	proto = "tcp"
}
Listening on auth address :: port 1812 bound to server test
Listening on auth proto tcp address :: port 1812 bound to server test
Listening on auth address * port 1812 bound to server test
Listening on auth proto tcp address * port 1812 bound to server test
Listening on proxy address * port 59910
Listening on proxy address :: port 36474
Ready to process requests
(0) Received Access-Request Id 86 from 127.0.0.1:50758 to 127.0.0.1:1812 length 202
(0)   User-Name = "anonymous@example.org"
(0)   NAS-IP-Address = 127.0.0.1
(0)   NAS-Identifier = "hostapd"
(0)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(0)   NAS-Port-Type = Wireless-802.11
(0)   Service-Type = Framed-User
(0)   Calling-Station-Id = "52-54-00-12-34-57"
(0)   Connect-Info = "CONNECT 0Mbps 802.11b"
(0)   Acct-Session-Id = "9B5B1191159BC00E"
(0)   Framed-MTU = 1400
(0)   EAP-Message = 0x02f8001a01616e6f6e796d6f7573406578616d706c652e6f7267
(0)   Message-Authenticator = 0x99c3fba4c221cd7774462e63fc49e70b
(0) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(0)   authorize {
(0)     if (User-Name == "bob") {
(0)     if (User-Name == "bob")  -> FALSE
(0)     [mschap] = noop
(0) eap-test: Peer sent EAP Response (code 2) ID 248 length 26
(0) eap-test: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(0)     [eap-test] = ok
Not doing PAP as Auth-Type is already set.
(0)     [pap] = noop
(0)   } # authorize = ok
(0) Found Auth-Type = eap-test
(0) # Executing group from file /etc/freeradius/sites-enabled/test
(0)   authenticate {
(0) eap-test: Peer sent packet with method EAP Identity (1)
(0) eap-test: Calling submodule eap_tls to process data
(0) eap_tls: (TLS) Initiating new session
(0) eap_tls: (TLS) Setting verify mode to require certificate from client
(0) eap-test: Sending EAP Request (code 1) ID 249 length 6
(0) eap-test: EAP session adding &reply:State = 0xd423e3ffd4daee49
(0)     [eap-test] = handled
(0)   } # authenticate = handled
(0) Using Post-Auth-Type Challenge
(0) Post-Auth-Type sub-section not found.  Ignoring.
(0) session-state: Saving cached attributes
(0)   Framed-MTU = 984
(0) Sent Access-Challenge Id 86 from 127.0.0.1:1812 to 127.0.0.1:50758 length 64
(0)   EAP-Message = 0x01f900060d20
(0)   Message-Authenticator = 0x00000000000000000000000000000000
(0)   State = 0xd423e3ffd4daee497564f89df5b41232
(0) Finished request
Waking up in 4.9 seconds.
(1) Received Access-Request Id 87 from 127.0.0.1:50758 to 127.0.0.1:1812 length 200
(1)   User-Name = "anonymous@example.org"
(1)   NAS-IP-Address = 127.0.0.1
(1)   NAS-Identifier = "hostapd"
(1)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(1)   NAS-Port-Type = Wireless-802.11
(1)   Service-Type = Framed-User
(1)   Calling-Station-Id = "52-54-00-12-34-57"
(1)   Connect-Info = "CONNECT 0Mbps 802.11b"
(1)   Acct-Session-Id = "9B5B1191159BC00E"
(1)   Framed-MTU = 1400
(1)   EAP-Message = 0x02f900060319
(1)   State = 0xd423e3ffd4daee497564f89df5b41232
(1)   Message-Authenticator = 0x703c071117dad8621a07fabbe4852f87
(1) Restoring &session-state
(1)   &session-state:Framed-MTU = 984
(1) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(1)   authorize {
(1)     if (User-Name == "bob") {
(1)     if (User-Name == "bob")  -> FALSE
(1)     [mschap] = noop
(1) eap-test: Peer sent EAP Response (code 2) ID 249 length 6
(1) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(1)     [eap-test] = updated
Not doing PAP as Auth-Type is already set.
(1)     [pap] = noop
(1)   } # authorize = updated
(1) Found Auth-Type = eap-test
(1) # Executing group from file /etc/freeradius/sites-enabled/test
(1)   authenticate {
(1) eap-test: Expiring EAP session with state 0xd423e3ffd4daee49
(1) eap-test: Finished EAP session with state 0xd423e3ffd4daee49
(1) eap-test: Previous EAP request found for state 0xd423e3ffd4daee49, released from the list
(1) eap-test: Peer sent packet with method EAP NAK (3)
(1) eap-test: Found mutually acceptable type PEAP (25)
(1) eap-test: Calling submodule eap_peap to process data
(1) eap_peap: (TLS) Initiating new session
(1) eap-test: Sending EAP Request (code 1) ID 250 length 6
(1) eap-test: EAP session adding &reply:State = 0xd423e3ffd5d9fa49
(1)     [eap-test] = handled
(1)   } # authenticate = handled
(1) Using Post-Auth-Type Challenge
(1) Post-Auth-Type sub-section not found.  Ignoring.
(1) session-state: Saving cached attributes
(1)   Framed-MTU = 984
(1) Sent Access-Challenge Id 87 from 127.0.0.1:1812 to 127.0.0.1:50758 length 64
(1)   EAP-Message = 0x01fa00061920
(1)   Message-Authenticator = 0x00000000000000000000000000000000
(1)   State = 0xd423e3ffd5d9fa497564f89df5b41232
(1) Finished request
Waking up in 4.9 seconds.
(2) Received Access-Request Id 88 from 127.0.0.1:50758 to 127.0.0.1:1812 length 457
(2)   User-Name = "anonymous@example.org"
(2)   NAS-IP-Address = 127.0.0.1
(2)   NAS-Identifier = "hostapd"
(2)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(2)   NAS-Port-Type = Wireless-802.11
(2)   Service-Type = Framed-User
(2)   Calling-Station-Id = "52-54-00-12-34-57"
(2)   Connect-Info = "CONNECT 0Mbps 802.11b"
(2)   Acct-Session-Id = "9B5B1191159BC00E"
(2)   Framed-MTU = 1400
(2)   EAP-Message = 0x02fa01051980000000fb16030100f6010000f20303ac01b449d6219e438344bec649ff929e8ad9d06f30a3b0a2c660bfb390086bc4203f8facbd1885380e7902322c04d60a7f48691de8cd7bc0e81d06487effcd5ea5002813021301c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000081000500050100000000002b0009080304030303020301000d001a001808040805080604010501020104030503020302020601060300230000000a00080006001d00170018003300260024001d00204051dcab45101beb2781b4a6b662c0a9e1bcc9a418f7f7b35f9472504f679b6b0031000000170000ff01000100002d00020101
(2)   State = 0xd423e3ffd5d9fa497564f89df5b41232
(2)   Message-Authenticator = 0x03cdd5f45c1fe63f6e2a1d2bde7e5ec3
(2) Restoring &session-state
(2)   &session-state:Framed-MTU = 984
(2) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(2)   authorize {
(2)     if (User-Name == "bob") {
(2)     if (User-Name == "bob")  -> FALSE
(2)     [mschap] = noop
(2) eap-test: Peer sent EAP Response (code 2) ID 250 length 261
(2) eap-test: Continuing tunnel setup
(2)     [eap-test] = ok
(2)     [pap] = noop
(2)   } # authorize = ok
(2) Found Auth-Type = eap-test
(2) # Executing group from file /etc/freeradius/sites-enabled/test
(2)   authenticate {
(2) eap-test: Expiring EAP session with state 0xd423e3ffd5d9fa49
(2) eap-test: Finished EAP session with state 0xd423e3ffd5d9fa49
(2) eap-test: Previous EAP request found for state 0xd423e3ffd5d9fa49, released from the list
(2) eap-test: Peer sent packet with method EAP PEAP (25)
(2) eap-test: Calling submodule eap_peap to process data
(2) eap_peap: (TLS) EAP Peer says that the final record size will be 251 bytes
(2) eap_peap: (TLS) EAP Got all data (251 bytes)
(2) eap_peap: (TLS) Handshake state - before SSL initialization
(2) eap_peap: (TLS) Handshake state - Server before SSL initialization
(2) eap_peap: (TLS) Handshake state - Server before SSL initialization
(2) eap_peap: (TLS) recv TLS 1.3 Handshake, ClientHello
(2) eap_peap: (TLS) Handshake state - Server SSLv3/TLS read client hello
(2) eap_peap: (TLS) send TLS 1.3 Handshake, ServerHello
(2) eap_peap: (TLS) Handshake state - Server SSLv3/TLS write server hello
(2) eap_peap: (TLS) send TLS 1.3 ChangeCipherSpec
(2) eap_peap: (TLS) Handshake state - Server SSLv3/TLS write change cipher spec
(2) eap_peap: (TLS) send TLS 1.3 Handshake, EncryptedExtensions
(2) eap_peap: (TLS) Handshake state - Server TLSv1.3 write encrypted extensions
(2) eap_peap: (TLS) send TLS 1.3 Handshake, Certificate
(2) eap_peap: (TLS) Handshake state - Server SSLv3/TLS write certificate
(2) eap_peap: (TLS) send TLS 1.3 Handshake, CertificateVerify
(2) eap_peap: (TLS) Handshake state - Server TLSv1.3 write server certificate verify
(2) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(2) eap_peap: (TLS) Handshake state - Server SSLv3/TLS write finished
(2) eap_peap: (TLS) Handshake state - Server TLSv1.3 early data
(2) eap_peap: (TLS) Server : Need to read more data: TLSv1.3 early data
(2) eap_peap: (TLS) In Handshake Phase
(2) eap-test: Sending EAP Request (code 1) ID 251 length 994
(2) eap-test: EAP session adding &reply:State = 0xd423e3ffd6d8fa49
(2)     [eap-test] = handled
(2)   } # authenticate = handled
(2) Using Post-Auth-Type Challenge
(2) Post-Auth-Type sub-section not found.  Ignoring.
(2) session-state: Saving cached attributes
(2)   Framed-MTU = 984
(2)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(2)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(2)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(2)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(2)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(2)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(2)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(2) Sent Access-Challenge Id 88 from 127.0.0.1:1812 to 127.0.0.1:50758 length 1058
(2)   EAP-Message = 0x01fb03e219c000000b27160303007a02000076030323ff6b4e5fd125c74c821e0a48816cc4b20737da7b2410a042cf29a0cf7df146203f8facbd1885380e7902322c04d60a7f48691de8cd7bc0e81d06487effcd5ea5130200002e002b0002030400330024001d002065b8488fd981864d184e8e92bed6a88b05619b0a5f0c0a025475fd4ba469af3e1403030001011703030017b7e2eb0eb13cba60beb7210ee0aeea03b0be17ff4135241703030919d2a90468637885aec1af9bb76e7d777b10de936da46362beeb41ba9382be2f129274d2a16eef1ace9aa0df87c2af8cdaebcb618a3cd7940275c446ce6f277d8e0e18a5446baa57cad700d8e664d2d356027a43841538f588fdbebd6054d6e1ff8378163cde9eb7cb88be6b767bba5a025f7cc2fef57c16bce35cd173a4347fe67a8b11f48f1286218ff6cf4f30efa7c5a5a05f3ab911102d7ea084bb47618fe14645208a9dd9b24abd8571478fc6f69e944360458e7b55524573f36eedf1b126557194fb8324df
(2)   Message-Authenticator = 0x00000000000000000000000000000000
(2)   State = 0xd423e3ffd6d8fa497564f89df5b41232
(2) Finished request
Waking up in 4.9 seconds.
(3) Received Access-Request Id 89 from 127.0.0.1:50758 to 127.0.0.1:1812 length 200
(3)   User-Name = "anonymous@example.org"
(3)   NAS-IP-Address = 127.0.0.1
(3)   NAS-Identifier = "hostapd"
(3)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(3)   NAS-Port-Type = Wireless-802.11
(3)   Service-Type = Framed-User
(3)   Calling-Station-Id = "52-54-00-12-34-57"
(3)   Connect-Info = "CONNECT 0Mbps 802.11b"
(3)   Acct-Session-Id = "9B5B1191159BC00E"
(3)   Framed-MTU = 1400
(3)   EAP-Message = 0x02fb00061900
(3)   State = 0xd423e3ffd6d8fa497564f89df5b41232
(3)   Message-Authenticator = 0x1ed4521d17e2fae5daae3101101a0184
(3) Restoring &session-state
(3)   &session-state:Framed-MTU = 984
(3)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(3)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(3) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(3)   authorize {
(3)     if (User-Name == "bob") {
(3)     if (User-Name == "bob")  -> FALSE
(3)     [mschap] = noop
(3) eap-test: Peer sent EAP Response (code 2) ID 251 length 6
(3) eap-test: Continuing tunnel setup
(3)     [eap-test] = ok
(3)     [pap] = noop
(3)   } # authorize = ok
(3) Found Auth-Type = eap-test
(3) # Executing group from file /etc/freeradius/sites-enabled/test
(3)   authenticate {
(3) eap-test: Expiring EAP session with state 0xd423e3ffd6d8fa49
(3) eap-test: Finished EAP session with state 0xd423e3ffd6d8fa49
(3) eap-test: Previous EAP request found for state 0xd423e3ffd6d8fa49, released from the list
(3) eap-test: Peer sent packet with method EAP PEAP (25)
(3) eap-test: Calling submodule eap_peap to process data
(3) eap_peap: (TLS) Peer ACKed our handshake fragment
(3) eap-test: Sending EAP Request (code 1) ID 252 length 990
(3) eap-test: EAP session adding &reply:State = 0xd423e3ffd7dffa49
(3)     [eap-test] = handled
(3)   } # authenticate = handled
(3) Using Post-Auth-Type Challenge
(3) Post-Auth-Type sub-section not found.  Ignoring.
(3) session-state: Saving cached attributes
(3)   Framed-MTU = 984
(3)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(3)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(3)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(3)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(3)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(3)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(3)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(3) Sent Access-Challenge Id 89 from 127.0.0.1:1812 to 127.0.0.1:50758 length 1054
(3)   EAP-Message = 0x01fc03de19407a6293ea8f908449a5f394e1146c926c61ba9ed101645defd4846f2631d463f0d3f7df3225887f932f5baa23255fe60e6f0a029477ec7e22b3458b89139e71574d67af73a619efadeea361d879ea33cfca6bca28cc481eb441588f65d6030a2f7e69aa19d3f0c1a330bc0a6f5b041e5b77745af126e4e6c3e719aedbe4ee44e16dad5f857b2d17ce4b573f18a6b54a447ecffef892900bf926d837e1f0feda0c8dc92bdfae417c1694e52c49584483b1f00a02c98864692b38a42d99d6dc7dad75cdf00d82c5695b76836674b73eb05ce118d2df3b5d180f5e15e0e7b1fd5c3a3ad16bd3a32929df9b6616c8376d62948bf1019ddfff449d36a962e7bb1de9185d226cbdff2db3fef4a78b07819e249b7b1961ca5a325c88e56766b4554e3d720d6978306f0d60c30101836668d2a1ac881ce2bd67fc04ad757d2bcf6d5ccc1f9f6af1f667040bee3d1ab258c251fe0b06d7ab74076dcb7ccae83fa7e3509d4b1085fd52bc8e33e4928ea1e98d0367dc6c
(3)   Message-Authenticator = 0x00000000000000000000000000000000
(3)   State = 0xd423e3ffd7dffa497564f89df5b41232
(3) Finished request
Waking up in 4.9 seconds.
(4) Received Access-Request Id 90 from 127.0.0.1:50758 to 127.0.0.1:1812 length 200
(4)   User-Name = "anonymous@example.org"
(4)   NAS-IP-Address = 127.0.0.1
(4)   NAS-Identifier = "hostapd"
(4)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(4)   NAS-Port-Type = Wireless-802.11
(4)   Service-Type = Framed-User
(4)   Calling-Station-Id = "52-54-00-12-34-57"
(4)   Connect-Info = "CONNECT 0Mbps 802.11b"
(4)   Acct-Session-Id = "9B5B1191159BC00E"
(4)   Framed-MTU = 1400
(4)   EAP-Message = 0x02fc00061900
(4)   State = 0xd423e3ffd7dffa497564f89df5b41232
(4)   Message-Authenticator = 0x14b6d6e4b63b0b80246d0d2d0843a0a1
(4) Restoring &session-state
(4)   &session-state:Framed-MTU = 984
(4)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(4)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(4) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(4)   authorize {
(4)     if (User-Name == "bob") {
(4)     if (User-Name == "bob")  -> FALSE
(4)     [mschap] = noop
(4) eap-test: Peer sent EAP Response (code 2) ID 252 length 6
(4) eap-test: Continuing tunnel setup
(4)     [eap-test] = ok
(4)     [pap] = noop
(4)   } # authorize = ok
(4) Found Auth-Type = eap-test
(4) # Executing group from file /etc/freeradius/sites-enabled/test
(4)   authenticate {
(4) eap-test: Expiring EAP session with state 0xd423e3ffd7dffa49
(4) eap-test: Finished EAP session with state 0xd423e3ffd7dffa49
(4) eap-test: Previous EAP request found for state 0xd423e3ffd7dffa49, released from the list
(4) eap-test: Peer sent packet with method EAP PEAP (25)
(4) eap-test: Calling submodule eap_peap to process data
(4) eap_peap: (TLS) Peer ACKed our handshake fragment
(4) eap-test: Sending EAP Request (code 1) ID 253 length 893
(4) eap-test: EAP session adding &reply:State = 0xd423e3ffd0defa49
(4)     [eap-test] = handled
(4)   } # authenticate = handled
(4) Using Post-Auth-Type Challenge
(4) Post-Auth-Type sub-section not found.  Ignoring.
(4) session-state: Saving cached attributes
(4)   Framed-MTU = 984
(4)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(4)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(4)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(4)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(4)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(4)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(4)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(4) Sent Access-Challenge Id 90 from 127.0.0.1:1812 to 127.0.0.1:50758 length 957
(4)   EAP-Message = 0x01fd037d19009dc1346c165d862d0489e5a71f6e66d26953cd2c6833a4e64a896a27a6ff051ea5bac4811b5b38718f4805242baf4eeb8939a84b542768c99dcdf02ae269529eaeb6a0044db66e580ca28b8f7dcf2b7f03b9edfbf1ea1f7f745201b55b083b3fbe8da4bef7be6bd88a8bb37a817aa9efd84c6152147bf7dd6ee391bf3d2e6eaf7c2492dab1bb6afabb9b3b24ae6d28269edb5aa5c81969dc205b1af257c85ea43ed05088cbc66d33f67d73cf35b6fc2ce0d375cb67b00a681340e4cecc137c6065ea27a42dc242abf8bc033699eafb0a3f30f473100f366d7e3962a7d99ad3228da272ba61746ba97fef9478487347db2c3c4d4e946a7c55cae5ae0f2c55a004551f697edead04cd635d74a43eddac0e65319c18bc8c77a47cd1e73e1b19b6cc8caa1c70aca19b085951d0877d4d8a401e85bf1083c0084b95953d6da13203969b2b20501022fddb730404d18265411a7e6c34dacf4f9eb14a72ac0abc74b02fc0432260d34d4a77721b4ac048949005b4
(4)   Message-Authenticator = 0x00000000000000000000000000000000
(4)   State = 0xd423e3ffd0defa497564f89df5b41232
(4) Finished request
Waking up in 4.9 seconds.
(5) Received Access-Request Id 91 from 127.0.0.1:50758 to 127.0.0.1:1812 length 284
(5)   User-Name = "anonymous@example.org"
(5)   NAS-IP-Address = 127.0.0.1
(5)   NAS-Identifier = "hostapd"
(5)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(5)   NAS-Port-Type = Wireless-802.11
(5)   Service-Type = Framed-User
(5)   Calling-Station-Id = "52-54-00-12-34-57"
(5)   Connect-Info = "CONNECT 0Mbps 802.11b"
(5)   Acct-Session-Id = "9B5B1191159BC00E"
(5)   Framed-MTU = 1400
(5)   EAP-Message = 0x02fd005a1980000000501403030001011703030045c11fbc9d1d4b01d51f2d49a1ec6aa9c8a98fbac0c687e156a080eeeb6058d8126af66e640ddab30e93cba61075c07dc76bf52031e3646ac2e068fe052ca7c4d9f5707d0caa
(5)   State = 0xd423e3ffd0defa497564f89df5b41232
(5)   Message-Authenticator = 0x314ac00be544b4bd1be033f6ba066085
(5) Restoring &session-state
(5)   &session-state:Framed-MTU = 984
(5)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(5)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(5) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(5)   authorize {
(5)     if (User-Name == "bob") {
(5)     if (User-Name == "bob")  -> FALSE
(5)     [mschap] = noop
(5) eap-test: Peer sent EAP Response (code 2) ID 253 length 90
(5) eap-test: Continuing tunnel setup
(5)     [eap-test] = ok
(5)     [pap] = noop
(5)   } # authorize = ok
(5) Found Auth-Type = eap-test
(5) # Executing group from file /etc/freeradius/sites-enabled/test
(5)   authenticate {
(5) eap-test: Expiring EAP session with state 0xd423e3ffd0defa49
(5) eap-test: Finished EAP session with state 0xd423e3ffd0defa49
(5) eap-test: Previous EAP request found for state 0xd423e3ffd0defa49, released from the list
(5) eap-test: Peer sent packet with method EAP PEAP (25)
(5) eap-test: Calling submodule eap_peap to process data
(5) eap_peap: (TLS) EAP Peer says that the final record size will be 80 bytes
(5) eap_peap: (TLS) EAP Got all data (80 bytes)
(5) eap_peap: (TLS) Handshake state - Server TLSv1.3 early data
(5) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(5) eap_peap: (TLS) Handshake state - Server SSLv3/TLS read finished
(5) eap_peap: (TLS) Handshake state - SSL negotiation finished successfully
(5) eap_peap: (TLS) Connection Established
(5) eap_peap:   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(5) eap_peap:   TLS-Session-Version = "TLS 1.3"
(5) eap_peap: (TLS) Application data.
(5) eap_peap: WARNING: (TLS) EAP No information in cached session 
(5) eap_peap: Session established.  Decoding tunneled attributes
(5) eap_peap: PEAP state TUNNEL ESTABLISHED
(5) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(5) eap-test: Sending EAP Request (code 1) ID 254 length 33
(5) eap-test: EAP session adding &reply:State = 0xd423e3ffd1ddfa49
(5)     [eap-test] = handled
(5)   } # authenticate = handled
(5) Using Post-Auth-Type Challenge
(5) Post-Auth-Type sub-section not found.  Ignoring.
(5) session-state: Saving cached attributes
(5)   Framed-MTU = 984
(5)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(5)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(5)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(5)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(5)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(5)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(5)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(5)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(5)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(5)   TLS-Session-Version = "TLS 1.3"
(5)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(5) Sent Access-Challenge Id 91 from 127.0.0.1:1812 to 127.0.0.1:50758 length 91
(5)   EAP-Message = 0x01fe0021190017030300164362bdf1581848e05cf760d10e66e643c077bfa6eb17
(5)   Message-Authenticator = 0x00000000000000000000000000000000
(5)   State = 0xd423e3ffd1ddfa497564f89df5b41232
(5) Finished request
Waking up in 4.9 seconds.
(6) Received Access-Request Id 92 from 127.0.0.1:50758 to 127.0.0.1:1812 length 239
(6)   User-Name = "anonymous@example.org"
(6)   NAS-IP-Address = 127.0.0.1
(6)   NAS-Identifier = "hostapd"
(6)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(6)   NAS-Port-Type = Wireless-802.11
(6)   Service-Type = Framed-User
(6)   Calling-Station-Id = "52-54-00-12-34-57"
(6)   Connect-Info = "CONNECT 0Mbps 802.11b"
(6)   Acct-Session-Id = "9B5B1191159BC00E"
(6)   Framed-MTU = 1400
(6)   EAP-Message = 0x02fe002d1900170303002208f41f8ed2198a79ee9dec9c6f025b507ae40aefdbdc682b1d22c43a4cad5f2cf3a0
(6)   State = 0xd423e3ffd1ddfa497564f89df5b41232
(6)   Message-Authenticator = 0x07aec2ba50159341d082a1e36dc802be
(6) Restoring &session-state
(6)   &session-state:Framed-MTU = 984
(6)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(6)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(6)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(6)   &session-state:TLS-Session-Version = "TLS 1.3"
(6)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(6) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(6)   authorize {
(6)     if (User-Name == "bob") {
(6)     if (User-Name == "bob")  -> FALSE
(6)     [mschap] = noop
(6) eap-test: Peer sent EAP Response (code 2) ID 254 length 45
(6) eap-test: Continuing tunnel setup
(6)     [eap-test] = ok
(6)     [pap] = noop
(6)   } # authorize = ok
(6) Found Auth-Type = eap-test
(6) # Executing group from file /etc/freeradius/sites-enabled/test
(6)   authenticate {
(6) eap-test: Expiring EAP session with state 0xd423e3ffd1ddfa49
(6) eap-test: Finished EAP session with state 0xd423e3ffd1ddfa49
(6) eap-test: Previous EAP request found for state 0xd423e3ffd1ddfa49, released from the list
(6) eap-test: Peer sent packet with method EAP PEAP (25)
(6) eap-test: Calling submodule eap_peap to process data
(6) eap_peap: (TLS) EAP Done initial handshake
(6) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(6) eap_peap: Session established.  Decoding tunneled attributes
(6) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(6) eap_peap: Identity - user@example.org
(6) eap_peap: Got inner identity 'user@example.org'
(6) eap_peap: Setting default EAP type for tunneled EAP session
(6) eap_peap: Got tunneled request
(6) eap_peap:   EAP-Message = 0x02fe00150175736572406578616d706c652e6f7267
(6) eap_peap: Setting User-Name to user@example.org
(6) eap_peap: Sending tunneled request to eap-test-inner
(6) eap_peap:   EAP-Message = 0x02fe00150175736572406578616d706c652e6f7267
(6) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(6) eap_peap:   User-Name = "user@example.org"
(6) Virtual server eap-test-inner received request
(6)   EAP-Message = 0x02fe00150175736572406578616d706c652e6f7267
(6)   FreeRADIUS-Proxied-To = 127.0.0.1
(6)   User-Name = "user@example.org"
(6) server eap-test-inner {
(6)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(6)     authorize {
(6)       policy filter_username {
(6)         if (&User-Name) {
(6)         if (&User-Name)  -> TRUE
(6)         if (&User-Name)  {
(6)           if (&User-Name =~ / /) {
(6)           if (&User-Name =~ / /)  -> FALSE
(6)           if (&User-Name =~ /@[^@]*@/ ) {
(6)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(6)           if (&User-Name =~ /\.\./ ) {
(6)           if (&User-Name =~ /\.\./ )  -> FALSE
(6)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(6)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(6)           if (&User-Name =~ /\.$/)  {
(6)           if (&User-Name =~ /\.$/)   -> FALSE
(6)           if (&User-Name =~ /@\./)  {
(6)           if (&User-Name =~ /@\./)   -> FALSE
(6)         } # if (&User-Name)  = notfound
(6)       } # policy filter_username = notfound
(6)       if (User-Name == "bob") {
(6)       if (User-Name == "bob")  -> FALSE
(6)       [mschap] = noop
(6) suffix: Checking for suffix after "@"
(6) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(6) suffix: No such realm "example.org"
(6)       [suffix] = noop
(6)       update control {
(6)         &Proxy-To-Realm := LOCAL
(6)       } # update control = noop
(6) eap-test: Peer sent EAP Response (code 2) ID 254 length 21
(6) eap-test: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(6)       [eap-test] = ok
(6)     } # authorize = ok
(6)   Found Auth-Type = eap-test
(6)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(6)     authenticate {
(6) eap-test: Peer sent packet with method EAP Identity (1)
(6) eap-test: Calling submodule eap_mschapv2 to process data
(6) eap_mschapv2: Issuing Challenge
(6) eap-test: Sending EAP Request (code 1) ID 255 length 43
(6) eap-test: EAP session adding &reply:State = 0x60424b7760bd5193
(6)       [eap-test] = handled
(6)     } # authenticate = handled
(6) } # server eap-test-inner
(6) Virtual server sending reply
(6)   EAP-Message = 0x01ff002b1a01ff0026109d5789a2f65890922db7adbabefc7a05667265657261646975732d332e302e3236
(6)   Message-Authenticator = 0x00000000000000000000000000000000
(6)   State = 0x60424b7760bd5193892ee51c5dcdb9ee
(6) eap_peap: Got tunneled reply code 11
(6) eap_peap:   EAP-Message = 0x01ff002b1a01ff0026109d5789a2f65890922db7adbabefc7a05667265657261646975732d332e302e3236
(6) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(6) eap_peap:   State = 0x60424b7760bd5193892ee51c5dcdb9ee
(6) eap_peap: Got tunneled reply RADIUS code 11
(6) eap_peap:   EAP-Message = 0x01ff002b1a01ff0026109d5789a2f65890922db7adbabefc7a05667265657261646975732d332e302e3236
(6) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(6) eap_peap:   State = 0x60424b7760bd5193892ee51c5dcdb9ee
(6) eap_peap: Got tunneled Access-Challenge
(6) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(6) eap-test: Sending EAP Request (code 1) ID 255 length 67
(6) eap-test: EAP session adding &reply:State = 0xd423e3ffd2dcfa49
(6)     [eap-test] = handled
(6)   } # authenticate = handled
(6) Using Post-Auth-Type Challenge
(6) Post-Auth-Type sub-section not found.  Ignoring.
(6) session-state: Saving cached attributes
(6)   Framed-MTU = 984
(6)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(6)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(6)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(6)   TLS-Session-Version = "TLS 1.3"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(6)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(6)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(6) Sent Access-Challenge Id 92 from 127.0.0.1:1812 to 127.0.0.1:50758 length 125
(6)   EAP-Message = 0x01ff0043190017030300381b89453d2dc4378db1b99fecf81029a8dba35c6b4d021b2b807fe3fa5164eda8062e280fe8f443b10e558f40fed782ee7ed5db6650907004
(6)   Message-Authenticator = 0x00000000000000000000000000000000
(6)   State = 0xd423e3ffd2dcfa497564f89df5b41232
(6) Finished request
Waking up in 4.9 seconds.
(7) Received Access-Request Id 93 from 127.0.0.1:50758 to 127.0.0.1:1812 length 224
(7)   User-Name = "anonymous@example.org"
(7)   NAS-IP-Address = 127.0.0.1
(7)   NAS-Identifier = "hostapd"
(7)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(7)   NAS-Port-Type = Wireless-802.11
(7)   Service-Type = Framed-User
(7)   Calling-Station-Id = "52-54-00-12-34-57"
(7)   Connect-Info = "CONNECT 0Mbps 802.11b"
(7)   Acct-Session-Id = "9B5B1191159BC00E"
(7)   Framed-MTU = 1400
(7)   EAP-Message = 0x02ff001e190017030300136c6da4888c6b5fb5f151482799740a04ecd492
(7)   State = 0xd423e3ffd2dcfa497564f89df5b41232
(7)   Message-Authenticator = 0x49b90eab4517fc95efeda458091863ce
(7) Restoring &session-state
(7)   &session-state:Framed-MTU = 984
(7)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(7)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(7)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(7)   &session-state:TLS-Session-Version = "TLS 1.3"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(7)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(7)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(7) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(7)   authorize {
(7)     if (User-Name == "bob") {
(7)     if (User-Name == "bob")  -> FALSE
(7)     [mschap] = noop
(7) eap-test: Peer sent EAP Response (code 2) ID 255 length 30
(7) eap-test: Continuing tunnel setup
(7)     [eap-test] = ok
(7)     [pap] = noop
(7)   } # authorize = ok
(7) Found Auth-Type = eap-test
(7) # Executing group from file /etc/freeradius/sites-enabled/test
(7)   authenticate {
(7) eap-test: Expiring EAP session with state 0x60424b7760bd5193
(7) eap-test: Finished EAP session with state 0xd423e3ffd2dcfa49
(7) eap-test: Previous EAP request found for state 0xd423e3ffd2dcfa49, released from the list
(7) eap-test: Peer sent packet with method EAP PEAP (25)
(7) eap-test: Calling submodule eap_peap to process data
(7) eap_peap: (TLS) EAP Done initial handshake
(7) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(7) eap_peap: Session established.  Decoding tunneled attributes
(7) eap_peap: PEAP state phase2
(7) eap_peap: EAP method NAK (3)
(7) eap_peap: Got tunneled request
(7) eap_peap:   EAP-Message = 0x02ff0006030d
(7) eap_peap: Setting User-Name to user@example.org
(7) eap_peap: Sending tunneled request to eap-test-inner
(7) eap_peap:   EAP-Message = 0x02ff0006030d
(7) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(7) eap_peap:   User-Name = "user@example.org"
(7) eap_peap:   State = 0x60424b7760bd5193892ee51c5dcdb9ee
(7) Virtual server eap-test-inner received request
(7)   EAP-Message = 0x02ff0006030d
(7)   FreeRADIUS-Proxied-To = 127.0.0.1
(7)   User-Name = "user@example.org"
(7)   State = 0x60424b7760bd5193892ee51c5dcdb9ee
(7) server eap-test-inner {
(7)   session-state: No cached attributes
(7)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(7)     authorize {
(7)       policy filter_username {
(7)         if (&User-Name) {
(7)         if (&User-Name)  -> TRUE
(7)         if (&User-Name)  {
(7)           if (&User-Name =~ / /) {
(7)           if (&User-Name =~ / /)  -> FALSE
(7)           if (&User-Name =~ /@[^@]*@/ ) {
(7)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(7)           if (&User-Name =~ /\.\./ ) {
(7)           if (&User-Name =~ /\.\./ )  -> FALSE
(7)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(7)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(7)           if (&User-Name =~ /\.$/)  {
(7)           if (&User-Name =~ /\.$/)   -> FALSE
(7)           if (&User-Name =~ /@\./)  {
(7)           if (&User-Name =~ /@\./)   -> FALSE
(7)         } # if (&User-Name)  = notfound
(7)       } # policy filter_username = notfound
(7)       if (User-Name == "bob") {
(7)       if (User-Name == "bob")  -> FALSE
(7)       [mschap] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(7) suffix: No such realm "example.org"
(7)       [suffix] = noop
(7)       update control {
(7)         &Proxy-To-Realm := LOCAL
(7)       } # update control = noop
(7) eap-test: Peer sent EAP Response (code 2) ID 255 length 6
(7) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(7)       [eap-test] = updated
(7)       [files] = noop
(7)       [pap] = noop
(7)     } # authorize = updated
(7)   Found Auth-Type = eap-test
(7)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(7)     authenticate {
(7) eap-test: Expiring EAP session with state 0x60424b7760bd5193
(7) eap-test: Finished EAP session with state 0x60424b7760bd5193
(7) eap-test: Previous EAP request found for state 0x60424b7760bd5193, released from the list
(7) eap-test: Peer sent packet with method EAP NAK (3)
(7) eap-test: Found mutually acceptable type TLS (13)
(7) eap-test: Calling submodule eap_tls to process data
(7) eap_tls: (TLS) Initiating new session
(7) eap_tls: (TLS) Setting verify mode to require certificate from client
(7) eap-test: Sending EAP Request (code 1) ID 0 length 6
(7) eap-test: EAP session adding &reply:State = 0x60424b7761424693
(7)       [eap-test] = handled
(7)     } # authenticate = handled
(7) } # server eap-test-inner
(7) Virtual server sending reply
(7)   EAP-Message = 0x010000060d20
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0x60424b7761424693892ee51c5dcdb9ee
(7) eap_peap: Got tunneled reply code 11
(7) eap_peap:   EAP-Message = 0x010000060d20
(7) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(7) eap_peap:   State = 0x60424b7761424693892ee51c5dcdb9ee
(7) eap_peap: Got tunneled reply RADIUS code 11
(7) eap_peap:   EAP-Message = 0x010000060d20
(7) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(7) eap_peap:   State = 0x60424b7761424693892ee51c5dcdb9ee
(7) eap_peap: Got tunneled Access-Challenge
(7) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(7) eap-test: Sending EAP Request (code 1) ID 0 length 30
(7) eap-test: EAP session adding &reply:State = 0xd423e3ffd323fa49
(7)     [eap-test] = handled
(7)   } # authenticate = handled
(7) Using Post-Auth-Type Challenge
(7) Post-Auth-Type sub-section not found.  Ignoring.
(7) session-state: Saving cached attributes
(7)   Framed-MTU = 984
(7)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(7)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(7)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(7)   TLS-Session-Version = "TLS 1.3"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(7)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(7)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(7)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(7) Sent Access-Challenge Id 93 from 127.0.0.1:1812 to 127.0.0.1:50758 length 88
(7)   EAP-Message = 0x0100001e19001703030013692d8f74f449eaf5962e9cf7af789a358b1e5f
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0xd423e3ffd323fa497564f89df5b41232
(7) Finished request
Waking up in 4.9 seconds.
(8) Received Access-Request Id 94 from 127.0.0.1:50758 to 127.0.0.1:1812 length 481
(8)   User-Name = "anonymous@example.org"
(8)   NAS-IP-Address = 127.0.0.1
(8)   NAS-Identifier = "hostapd"
(8)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(8)   NAS-Port-Type = Wireless-802.11
(8)   Service-Type = Framed-User
(8)   Calling-Station-Id = "52-54-00-12-34-57"
(8)   Connect-Info = "CONNECT 0Mbps 802.11b"
(8)   Acct-Session-Id = "9B5B1191159BC00E"
(8)   Framed-MTU = 1400
(8)   EAP-Message = 0x0200011d19001703030112062aa2819786d25872859e604b8a2c34ed4831c3515b90d2dd9eee21db18487fd0bba59f20eac392bc72d9cb56deb6c526b4cf9e946cfea94b9c9f9bafab3bb6a384d6a1f4556928cc893d506ed13b505bd20a610f03b823181b08d4eebb06ff8fd7db591ff175e46f75a15cb25ef61dfba7dc99b8199ebf59f7ed3b65e05d89b7be109554894149b73c857c2f69b63e411c8579e5476e8ccfaabd6ca503e002dd1f60c55bac3598d4ea84fd7c05fd319bdd8a67dff2f4b7c5b8032a557d52d1ceaf2a5ba2d1a3ffc05739f8ab27b746c9cb94dd77b389566dde104c93acf860489fc0f1dbd9140ee570304c05876786a50fa2a3a1b5be5eb7edabd7db717336b3cd96d97d7268f00b15fa349c05a1fb16bf
(8)   State = 0xd423e3ffd323fa497564f89df5b41232
(8)   Message-Authenticator = 0xfeec43e67de1995069bffd0b3746ed7c
(8) Restoring &session-state
(8)   &session-state:Framed-MTU = 984
(8)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(8)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(8)   &session-state:TLS-Session-Version = "TLS 1.3"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(8)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(8)   authorize {
(8)     if (User-Name == "bob") {
(8)     if (User-Name == "bob")  -> FALSE
(8)     [mschap] = noop
(8) eap-test: Peer sent EAP Response (code 2) ID 0 length 285
(8) eap-test: Continuing tunnel setup
(8)     [eap-test] = ok
(8)     [pap] = noop
(8)   } # authorize = ok
(8) Found Auth-Type = eap-test
(8) # Executing group from file /etc/freeradius/sites-enabled/test
(8)   authenticate {
(8) eap-test: Expiring EAP session with state 0x60424b7761424693
(8) eap-test: Finished EAP session with state 0xd423e3ffd323fa49
(8) eap-test: Previous EAP request found for state 0xd423e3ffd323fa49, released from the list
(8) eap-test: Peer sent packet with method EAP PEAP (25)
(8) eap-test: Calling submodule eap_peap to process data
(8) eap_peap: (TLS) EAP Done initial handshake
(8) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(8) eap_peap: Session established.  Decoding tunneled attributes
(8) eap_peap: PEAP state phase2
(8) eap_peap: EAP method TLS (13)
(8) eap_peap: Got tunneled request
(8) eap_peap:   EAP-Message = 0x020001050d80000000fb16030100f6010000f20303ccb9d7851296356a88c489488e8765677992cc2ee4d9cafbb72cc4e8e27efcee20fed3196e661fa0c95b5e93bfe464fbadcdcafa20ab3f8c984d50f9208832905e002813021301c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000081000500050100000000002b0009080304030303020301000d001a001808040805080604010501020104030503020302020601060300230000000a00080006001d00170018003300260024001d002049a76559204d35677f0391889f282b9cd3fb502d6ca18e50ee0e9e80c64065750031000000170000ff0100
(8) eap_peap:   EAP-Message = 0x0100002d00020101
(8) eap_peap: Setting User-Name to user@example.org
(8) eap_peap: Sending tunneled request to eap-test-inner
(8) eap_peap:   EAP-Message = 0x020001050d80000000fb16030100f6010000f20303ccb9d7851296356a88c489488e8765677992cc2ee4d9cafbb72cc4e8e27efcee20fed3196e661fa0c95b5e93bfe464fbadcdcafa20ab3f8c984d50f9208832905e002813021301c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000081000500050100000000002b0009080304030303020301000d001a001808040805080604010501020104030503020302020601060300230000000a00080006001d00170018003300260024001d002049a76559204d35677f0391889f282b9cd3fb502d6ca18e50ee0e9e80c64065750031000000170000ff0100
(8) eap_peap:   EAP-Message = 0x0100002d00020101
(8) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(8) eap_peap:   User-Name = "user@example.org"
(8) eap_peap:   State = 0x60424b7761424693892ee51c5dcdb9ee
(8) Virtual server eap-test-inner received request
(8)   EAP-Message = 0x020001050d80000000fb16030100f6010000f20303ccb9d7851296356a88c489488e8765677992cc2ee4d9cafbb72cc4e8e27efcee20fed3196e661fa0c95b5e93bfe464fbadcdcafa20ab3f8c984d50f9208832905e002813021301c02cc02bc030c02fc024c023c028c027c00ac009c014c013009d009c003d003c0035002f01000081000500050100000000002b0009080304030303020301000d001a001808040805080604010501020104030503020302020601060300230000000a00080006001d00170018003300260024001d002049a76559204d35677f0391889f282b9cd3fb502d6ca18e50ee0e9e80c64065750031000000170000ff0100
(8)   EAP-Message = 0x0100002d00020101
(8)   FreeRADIUS-Proxied-To = 127.0.0.1
(8)   User-Name = "user@example.org"
(8)   State = 0x60424b7761424693892ee51c5dcdb9ee
(8) server eap-test-inner {
(8)   session-state: No cached attributes
(8)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(8)     authorize {
(8)       policy filter_username {
(8)         if (&User-Name) {
(8)         if (&User-Name)  -> TRUE
(8)         if (&User-Name)  {
(8)           if (&User-Name =~ / /) {
(8)           if (&User-Name =~ / /)  -> FALSE
(8)           if (&User-Name =~ /@[^@]*@/ ) {
(8)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(8)           if (&User-Name =~ /\.\./ ) {
(8)           if (&User-Name =~ /\.\./ )  -> FALSE
(8)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(8)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(8)           if (&User-Name =~ /\.$/)  {
(8)           if (&User-Name =~ /\.$/)   -> FALSE
(8)           if (&User-Name =~ /@\./)  {
(8)           if (&User-Name =~ /@\./)   -> FALSE
(8)         } # if (&User-Name)  = notfound
(8)       } # policy filter_username = notfound
(8)       if (User-Name == "bob") {
(8)       if (User-Name == "bob")  -> FALSE
(8)       [mschap] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(8) suffix: No such realm "example.org"
(8)       [suffix] = noop
(8)       update control {
(8)         &Proxy-To-Realm := LOCAL
(8)       } # update control = noop
(8) eap-test: Peer sent EAP Response (code 2) ID 0 length 253
(8) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(8)       [eap-test] = updated
(8)       [files] = noop
(8)       [pap] = noop
(8)     } # authorize = updated
(8)   Found Auth-Type = eap-test
(8)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(8)     authenticate {
(8) eap-test: Expiring EAP session with state 0x60424b7761424693
(8) eap-test: Finished EAP session with state 0x60424b7761424693
(8) eap-test: Previous EAP request found for state 0x60424b7761424693, released from the list
(8) eap-test: Peer sent packet with method EAP TLS (13)
(8) eap-test: Calling submodule eap_tls to process data
(8) eap_tls: (TLS) EAP Peer says that the final record size will be 251 bytes
(8) eap_tls: (TLS) EAP Got all data (251 bytes)
(8) eap_tls: (TLS) Handshake state - before SSL initialization
(8) eap_tls: (TLS) Handshake state - Server before SSL initialization
(8) eap_tls: (TLS) Handshake state - Server before SSL initialization
(8) eap_tls: (TLS) recv TLS 1.3 Handshake, ClientHello
(8) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read client hello
(8) eap_tls: (TLS) send TLS 1.3 Handshake, ServerHello
(8) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write server hello
(8) eap_tls: (TLS) send TLS 1.3 ChangeCipherSpec
(8) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write change cipher spec
(8) eap_tls: (TLS) send TLS 1.3 Handshake, EncryptedExtensions
(8) eap_tls: (TLS) Handshake state - Server TLSv1.3 write encrypted extensions
(8) eap_tls: (TLS) send TLS 1.3 Handshake, CertificateRequest
(8) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write certificate request
(8) eap_tls: (TLS) send TLS 1.3 Handshake, Certificate
(8) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write certificate
(8) eap_tls: (TLS) send TLS 1.3 Handshake, CertificateVerify
(8) eap_tls: (TLS) Handshake state - Server TLSv1.3 write server certificate verify
(8) eap_tls: (TLS) send TLS 1.3 Handshake, Finished
(8) eap_tls: (TLS) Handshake state - Server SSLv3/TLS write finished
(8) eap_tls: (TLS) Handshake state - Server TLSv1.3 early data
(8) eap_tls: (TLS) Server : Need to read more data: TLSv1.3 early data
(8) eap_tls: (TLS) In Handshake Phase
(8) eap-test: Sending EAP Request (code 1) ID 1 length 931
(8) eap-test: EAP session adding &reply:State = 0x60424b7762434693
(8)       [eap-test] = handled
(8)     } # authenticate = handled
(8) } # server eap-test-inner
(8) Virtual server sending reply
(8)   EAP-Message = 0x010103a30dc000000c08160303007a0200007603033c60f5632a414b5e8a8167513144b62cf3f46c2db5c3ed04ac2997dfbbca667820fed3196e661fa0c95b5e93bfe464fbadcdcafa20ab3f8c984d50f9208832905e130200002e002b0002030400330024001d002039e7d4554f1055540f7687af922c43fe0159cd274f875e1cc3f8e4c05679bd6714030300010117030300179e3081a912d4591ec6e8bbe97a5da77c9c1c2e3f4617c517030300dc7440542367980f79eb688a5a3cf459232f3bdab1604b00b9e442aa43449a03be43eba27a9adfa854c90cfa6e0ef1e2f4e59f7c456a90df33c177fef1a76eb2a31f0a6ca2ead807e836aa4ea0a6bd36508d93d8caafa2dd1a3d6e328cd2f6af250ef9dd620e083e06ad2c404b282fdf02cf82f4e1893c18ed26bd743a6a38d42a22cedf377a218f850531dfb1384af5e5a2b696836fd86a4ccc814536de04e3ee8124260db653a425817705f5917b96ab33b27b45a653451b900720413bd8ab8cd6a4fa4bcbec73
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8)   State = 0x60424b7762434693892ee51c5dcdb9ee
(8) eap_peap: Got tunneled reply code 11
(8) eap_peap:   EAP-Message = 0x010103a30dc000000c08160303007a0200007603033c60f5632a414b5e8a8167513144b62cf3f46c2db5c3ed04ac2997dfbbca667820fed3196e661fa0c95b5e93bfe464fbadcdcafa20ab3f8c984d50f9208832905e130200002e002b0002030400330024001d002039e7d4554f1055540f7687af922c43fe0159cd274f875e1cc3f8e4c05679bd6714030300010117030300179e3081a912d4591ec6e8bbe97a5da77c9c1c2e3f4617c517030300dc7440542367980f79eb688a5a3cf459232f3bdab1604b00b9e442aa43449a03be43eba27a9adfa854c90cfa6e0ef1e2f4e59f7c456a90df33c177fef1a76eb2a31f0a6ca2ead807e836aa4ea0a6bd36508d93d8caafa2dd1a3d6e328cd2f6af250ef9dd620e083e06ad2c404b282fdf02cf82f4e1893c18ed26bd743a6a38d42a22cedf377a218f850531dfb1384af5e5a2b696836fd86a4ccc814536de04e3ee8124260db653a425817705f5917b96ab33b27b45a653451b900720413bd8ab8cd6a4fa4bcbec73
(8) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(8) eap_peap:   State = 0x60424b7762434693892ee51c5dcdb9ee
(8) eap_peap: Got tunneled reply RADIUS code 11
(8) eap_peap:   EAP-Message = 0x010103a30dc000000c08160303007a0200007603033c60f5632a414b5e8a8167513144b62cf3f46c2db5c3ed04ac2997dfbbca667820fed3196e661fa0c95b5e93bfe464fbadcdcafa20ab3f8c984d50f9208832905e130200002e002b0002030400330024001d002039e7d4554f1055540f7687af922c43fe0159cd274f875e1cc3f8e4c05679bd6714030300010117030300179e3081a912d4591ec6e8bbe97a5da77c9c1c2e3f4617c517030300dc7440542367980f79eb688a5a3cf459232f3bdab1604b00b9e442aa43449a03be43eba27a9adfa854c90cfa6e0ef1e2f4e59f7c456a90df33c177fef1a76eb2a31f0a6ca2ead807e836aa4ea0a6bd36508d93d8caafa2dd1a3d6e328cd2f6af250ef9dd620e083e06ad2c404b282fdf02cf82f4e1893c18ed26bd743a6a38d42a22cedf377a218f850531dfb1384af5e5a2b696836fd86a4ccc814536de04e3ee8124260db653a425817705f5917b96ab33b27b45a653451b900720413bd8ab8cd6a4fa4bcbec73
(8) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(8) eap_peap:   State = 0x60424b7762434693892ee51c5dcdb9ee
(8) eap_peap: Got tunneled Access-Challenge
(8) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(8) eap-test: Sending EAP Request (code 1) ID 1 length 955
(8) eap-test: EAP session adding &reply:State = 0xd423e3ffdc22fa49
(8)     [eap-test] = handled
(8)   } # authenticate = handled
(8) Using Post-Auth-Type Challenge
(8) Post-Auth-Type sub-section not found.  Ignoring.
(8) session-state: Saving cached attributes
(8)   Framed-MTU = 984
(8)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(8)   TLS-Session-Version = "TLS 1.3"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(8)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(8) Sent Access-Challenge Id 94 from 127.0.0.1:1812 to 127.0.0.1:50758 length 1019
(8)   EAP-Message = 0x010103bb190017030303b0ba90154c6f23be30e7b97b7861df7d2f7b5b82a326a4462581bfe63fa3892eae2b899b25d1f6253700e8d927645760331790afb77b94bfc32c5309fa6ebbe16a010f80b20d057a0d4d0386d926a5b2db1f86ffc2e1de0160663ab65295bfdfefd49c36a18347eec6fe889adc13912e9d89260b18c1f8cef77675c96f810fb50484833685d50ec3559237a1d260289819c1b6dea39038247a33e625d5945e1713bf0d32c90fde4c0bfbd7ea4ac060808e3408acb92cb0bca8de38a85e5a952c9f7418ec3d2737bf890035cfc852592e50d55551c23fc9c9722c7853e46c289397bf039798f20b79f1d667abfa244f63cc5a6b7065d0856d55a4aeca040984e47d9088a8bec7f92d1bda32792c8d3b87dbb8559e65d29b0433fd245754925a8b403437c974647dacd1d0c2fcb4636dab2a3d4f3377bf14b4de96c3b5433bb78805e9c0677ede14e0c5c0a280bfe7eb3a139faeb90af01a121cb006b86666ed3fd16f846851084fc7b817e6ae61
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8)   State = 0xd423e3ffdc22fa497564f89df5b41232
(8) Finished request
Waking up in 4.9 seconds.
(9) Received Access-Request Id 95 from 127.0.0.1:50758 to 127.0.0.1:1812 length 224
(9)   User-Name = "anonymous@example.org"
(9)   NAS-IP-Address = 127.0.0.1
(9)   NAS-Identifier = "hostapd"
(9)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(9)   NAS-Port-Type = Wireless-802.11
(9)   Service-Type = Framed-User
(9)   Calling-Station-Id = "52-54-00-12-34-57"
(9)   Connect-Info = "CONNECT 0Mbps 802.11b"
(9)   Acct-Session-Id = "9B5B1191159BC00E"
(9)   Framed-MTU = 1400
(9)   EAP-Message = 0x0201001e190017030300130f9edef6c952aa740dfd99744ce50e3305fad1
(9)   State = 0xd423e3ffdc22fa497564f89df5b41232
(9)   Message-Authenticator = 0xae5ecdd6c7afdbdaaf29b337bd95129c
(9) Restoring &session-state
(9)   &session-state:Framed-MTU = 984
(9)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(9)   &session-state:TLS-Session-Version = "TLS 1.3"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(9)   authorize {
(9)     if (User-Name == "bob") {
(9)     if (User-Name == "bob")  -> FALSE
(9)     [mschap] = noop
(9) eap-test: Peer sent EAP Response (code 2) ID 1 length 30
(9) eap-test: Continuing tunnel setup
(9)     [eap-test] = ok
(9)     [pap] = noop
(9)   } # authorize = ok
(9) Found Auth-Type = eap-test
(9) # Executing group from file /etc/freeradius/sites-enabled/test
(9)   authenticate {
(9) eap-test: Expiring EAP session with state 0x60424b7762434693
(9) eap-test: Finished EAP session with state 0xd423e3ffdc22fa49
(9) eap-test: Previous EAP request found for state 0xd423e3ffdc22fa49, released from the list
(9) eap-test: Peer sent packet with method EAP PEAP (25)
(9) eap-test: Calling submodule eap_peap to process data
(9) eap_peap: (TLS) EAP Done initial handshake
(9) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(9) eap_peap: Session established.  Decoding tunneled attributes
(9) eap_peap: PEAP state phase2
(9) eap_peap: EAP method TLS (13)
(9) eap_peap: Got tunneled request
(9) eap_peap:   EAP-Message = 0x020100060d00
(9) eap_peap: Setting User-Name to user@example.org
(9) eap_peap: Sending tunneled request to eap-test-inner
(9) eap_peap:   EAP-Message = 0x020100060d00
(9) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(9) eap_peap:   User-Name = "user@example.org"
(9) eap_peap:   State = 0x60424b7762434693892ee51c5dcdb9ee
(9) Virtual server eap-test-inner received request
(9)   EAP-Message = 0x020100060d00
(9)   FreeRADIUS-Proxied-To = 127.0.0.1
(9)   User-Name = "user@example.org"
(9)   State = 0x60424b7762434693892ee51c5dcdb9ee
(9) server eap-test-inner {
(9)   session-state: No cached attributes
(9)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(9)     authorize {
(9)       policy filter_username {
(9)         if (&User-Name) {
(9)         if (&User-Name)  -> TRUE
(9)         if (&User-Name)  {
(9)           if (&User-Name =~ / /) {
(9)           if (&User-Name =~ / /)  -> FALSE
(9)           if (&User-Name =~ /@[^@]*@/ ) {
(9)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(9)           if (&User-Name =~ /\.\./ ) {
(9)           if (&User-Name =~ /\.\./ )  -> FALSE
(9)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(9)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(9)           if (&User-Name =~ /\.$/)  {
(9)           if (&User-Name =~ /\.$/)   -> FALSE
(9)           if (&User-Name =~ /@\./)  {
(9)           if (&User-Name =~ /@\./)   -> FALSE
(9)         } # if (&User-Name)  = notfound
(9)       } # policy filter_username = notfound
(9)       if (User-Name == "bob") {
(9)       if (User-Name == "bob")  -> FALSE
(9)       [mschap] = noop
(9) suffix: Checking for suffix after "@"
(9) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(9) suffix: No such realm "example.org"
(9)       [suffix] = noop
(9)       update control {
(9)         &Proxy-To-Realm := LOCAL
(9)       } # update control = noop
(9) eap-test: Peer sent EAP Response (code 2) ID 1 length 6
(9) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(9)       [eap-test] = updated
(9)       [files] = noop
(9)       [pap] = noop
(9)     } # authorize = updated
(9)   Found Auth-Type = eap-test
(9)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(9)     authenticate {
(9) eap-test: Expiring EAP session with state 0x60424b7762434693
(9) eap-test: Finished EAP session with state 0x60424b7762434693
(9) eap-test: Previous EAP request found for state 0x60424b7762434693, released from the list
(9) eap-test: Peer sent packet with method EAP TLS (13)
(9) eap-test: Calling submodule eap_tls to process data
(9) eap_tls: (TLS) Peer ACKed our handshake fragment
(9) eap-test: Sending EAP Request (code 1) ID 2 length 931
(9) eap-test: EAP session adding &reply:State = 0x60424b7763404693
(9)       [eap-test] = handled
(9)     } # authenticate = handled
(9) } # server eap-test-inner
(9) Virtual server sending reply
(9)   EAP-Message = 0x010203a30dc000000c081bf060de7143410b15773a9e76b324265b5b0204ab9fc9d6de1112297783d97677176fff930c7e27d6895ec1251205afda7792f5615e1c9686d970899dd6c09474a34a9068e17a922f2950ab132dbca0494067ce22ef531ba5138351b7218f1221c388270b841ab2b1926971d5c04a39276e5ab02347238d0c3db284b6e00b2844d47c129b0afc8ea084ecf386093553b5120351834da85a94c2835b04c19bab5f793cd064f83cfabe7633f9f81e8207103828e3490511733dd9e9d8e7383a6c55acfbcc2b847146308a8882c51c3fa75a85bd23a81ebc039427ce385729e10f361b8ba928a2304072701a39a09e64c066f47b9bf3a264de01c12e2ff97d0c76ff663840ed0019b99c9a782f4bf2bf99fa65b3f51986c38863274cadfe29a7830a26e05703afa5e43a5cfb86ed991ffb3b57f1510df7ba0f2c0246a35946d67e07108acda7937df95a2a1a634a2b0b7171305d95eed41cb6b1462ae4f7275560a444adf52ce8d51cd5fb7639ab
(9)   Message-Authenticator = 0x00000000000000000000000000000000
(9)   State = 0x60424b7763404693892ee51c5dcdb9ee
(9) eap_peap: Got tunneled reply code 11
(9) eap_peap:   EAP-Message = 0x010203a30dc000000c081bf060de7143410b15773a9e76b324265b5b0204ab9fc9d6de1112297783d97677176fff930c7e27d6895ec1251205afda7792f5615e1c9686d970899dd6c09474a34a9068e17a922f2950ab132dbca0494067ce22ef531ba5138351b7218f1221c388270b841ab2b1926971d5c04a39276e5ab02347238d0c3db284b6e00b2844d47c129b0afc8ea084ecf386093553b5120351834da85a94c2835b04c19bab5f793cd064f83cfabe7633f9f81e8207103828e3490511733dd9e9d8e7383a6c55acfbcc2b847146308a8882c51c3fa75a85bd23a81ebc039427ce385729e10f361b8ba928a2304072701a39a09e64c066f47b9bf3a264de01c12e2ff97d0c76ff663840ed0019b99c9a782f4bf2bf99fa65b3f51986c38863274cadfe29a7830a26e05703afa5e43a5cfb86ed991ffb3b57f1510df7ba0f2c0246a35946d67e07108acda7937df95a2a1a634a2b0b7171305d95eed41cb6b1462ae4f7275560a444adf52ce8d51cd5fb7639ab
(9) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(9) eap_peap:   State = 0x60424b7763404693892ee51c5dcdb9ee
(9) eap_peap: Got tunneled reply RADIUS code 11
(9) eap_peap:   EAP-Message = 0x010203a30dc000000c081bf060de7143410b15773a9e76b324265b5b0204ab9fc9d6de1112297783d97677176fff930c7e27d6895ec1251205afda7792f5615e1c9686d970899dd6c09474a34a9068e17a922f2950ab132dbca0494067ce22ef531ba5138351b7218f1221c388270b841ab2b1926971d5c04a39276e5ab02347238d0c3db284b6e00b2844d47c129b0afc8ea084ecf386093553b5120351834da85a94c2835b04c19bab5f793cd064f83cfabe7633f9f81e8207103828e3490511733dd9e9d8e7383a6c55acfbcc2b847146308a8882c51c3fa75a85bd23a81ebc039427ce385729e10f361b8ba928a2304072701a39a09e64c066f47b9bf3a264de01c12e2ff97d0c76ff663840ed0019b99c9a782f4bf2bf99fa65b3f51986c38863274cadfe29a7830a26e05703afa5e43a5cfb86ed991ffb3b57f1510df7ba0f2c0246a35946d67e07108acda7937df95a2a1a634a2b0b7171305d95eed41cb6b1462ae4f7275560a444adf52ce8d51cd5fb7639ab
(9) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(9) eap_peap:   State = 0x60424b7763404693892ee51c5dcdb9ee
(9) eap_peap: Got tunneled Access-Challenge
(9) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(9) eap-test: Sending EAP Request (code 1) ID 2 length 955
(9) eap-test: EAP session adding &reply:State = 0xd423e3ffdd21fa49
(9)     [eap-test] = handled
(9)   } # authenticate = handled
(9) Using Post-Auth-Type Challenge
(9) Post-Auth-Type sub-section not found.  Ignoring.
(9) session-state: Saving cached attributes
(9)   Framed-MTU = 984
(9)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(9)   TLS-Session-Version = "TLS 1.3"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(9)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(9) Sent Access-Challenge Id 95 from 127.0.0.1:1812 to 127.0.0.1:50758 length 1019
(9)   EAP-Message = 0x010203bb190017030303b06bd5a989cd3124245a05600a9478ef784c92ad69f8920737592491a8bb2fbd3040689c1051025ed4eaacdd5a6d9561d312b3551e61e1b95ad0215d7277ea1f7470cd068904f4ee26ae1e008c54111651bdc5f1a26b612de91164c8ce576243d6a65ba6fc7844d6530b7778c21fe2da66d8f69283f05409764a4ed46aced7220cee4225177c6a27d961fe930bf4450a6511d0990b4aefca05e17cd5634a5704889bbba10252e410ae073b4fc6deb40b342c9d4c25a906f2f9fab31550247e36758a39934bb258f6f81051d0e8f7ed69b060a2fd99b64d7655401fa352fe7fcb7390517dd793a95735892d37de70135f0179f1ddee72ac05a8df6447db9796aa89240ebbdbedeb6751932822a1d9700893e84e2ffe9c96d05776832c6b760b7de4107fb7c889a06ae68ed43a95fceeee8624b3596c5e30a0c1fb1e5b6be3955523c2418af97d9a6e17de2b24d3eaad9b85fe7db67d959c6061247d17122ff58fbac4e909e6d6fe4b6d1d866ce4
(9)   Message-Authenticator = 0x00000000000000000000000000000000
(9)   State = 0xd423e3ffdd21fa497564f89df5b41232
(9) Finished request
Waking up in 4.9 seconds.
(10) Received Access-Request Id 96 from 127.0.0.1:50758 to 127.0.0.1:1812 length 224
(10)   User-Name = "anonymous@example.org"
(10)   NAS-IP-Address = 127.0.0.1
(10)   NAS-Identifier = "hostapd"
(10)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(10)   NAS-Port-Type = Wireless-802.11
(10)   Service-Type = Framed-User
(10)   Calling-Station-Id = "52-54-00-12-34-57"
(10)   Connect-Info = "CONNECT 0Mbps 802.11b"
(10)   Acct-Session-Id = "9B5B1191159BC00E"
(10)   Framed-MTU = 1400
(10)   EAP-Message = 0x0202001e190017030300136a6b15e777b7d855a001b0981d0cd43464e845
(10)   State = 0xd423e3ffdd21fa497564f89df5b41232
(10)   Message-Authenticator = 0x699d9dda6c41a72a0745a4764fe18202
(10) Restoring &session-state
(10)   &session-state:Framed-MTU = 984
(10)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(10)   &session-state:TLS-Session-Version = "TLS 1.3"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(10)   authorize {
(10)     if (User-Name == "bob") {
(10)     if (User-Name == "bob")  -> FALSE
(10)     [mschap] = noop
(10) eap-test: Peer sent EAP Response (code 2) ID 2 length 30
(10) eap-test: Continuing tunnel setup
(10)     [eap-test] = ok
(10)     [pap] = noop
(10)   } # authorize = ok
(10) Found Auth-Type = eap-test
(10) # Executing group from file /etc/freeradius/sites-enabled/test
(10)   authenticate {
(10) eap-test: Expiring EAP session with state 0x60424b7763404693
(10) eap-test: Finished EAP session with state 0xd423e3ffdd21fa49
(10) eap-test: Previous EAP request found for state 0xd423e3ffdd21fa49, released from the list
(10) eap-test: Peer sent packet with method EAP PEAP (25)
(10) eap-test: Calling submodule eap_peap to process data
(10) eap_peap: (TLS) EAP Done initial handshake
(10) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(10) eap_peap: Session established.  Decoding tunneled attributes
(10) eap_peap: PEAP state phase2
(10) eap_peap: EAP method TLS (13)
(10) eap_peap: Got tunneled request
(10) eap_peap:   EAP-Message = 0x020200060d00
(10) eap_peap: Setting User-Name to user@example.org
(10) eap_peap: Sending tunneled request to eap-test-inner
(10) eap_peap:   EAP-Message = 0x020200060d00
(10) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(10) eap_peap:   User-Name = "user@example.org"
(10) eap_peap:   State = 0x60424b7763404693892ee51c5dcdb9ee
(10) Virtual server eap-test-inner received request
(10)   EAP-Message = 0x020200060d00
(10)   FreeRADIUS-Proxied-To = 127.0.0.1
(10)   User-Name = "user@example.org"
(10)   State = 0x60424b7763404693892ee51c5dcdb9ee
(10) server eap-test-inner {
(10)   session-state: No cached attributes
(10)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(10)     authorize {
(10)       policy filter_username {
(10)         if (&User-Name) {
(10)         if (&User-Name)  -> TRUE
(10)         if (&User-Name)  {
(10)           if (&User-Name =~ / /) {
(10)           if (&User-Name =~ / /)  -> FALSE
(10)           if (&User-Name =~ /@[^@]*@/ ) {
(10)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(10)           if (&User-Name =~ /\.\./ ) {
(10)           if (&User-Name =~ /\.\./ )  -> FALSE
(10)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(10)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(10)           if (&User-Name =~ /\.$/)  {
(10)           if (&User-Name =~ /\.$/)   -> FALSE
(10)           if (&User-Name =~ /@\./)  {
(10)           if (&User-Name =~ /@\./)   -> FALSE
(10)         } # if (&User-Name)  = notfound
(10)       } # policy filter_username = notfound
(10)       if (User-Name == "bob") {
(10)       if (User-Name == "bob")  -> FALSE
(10)       [mschap] = noop
(10) suffix: Checking for suffix after "@"
(10) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(10) suffix: No such realm "example.org"
(10)       [suffix] = noop
(10)       update control {
(10)         &Proxy-To-Realm := LOCAL
(10)       } # update control = noop
(10) eap-test: Peer sent EAP Response (code 2) ID 2 length 6
(10) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(10)       [eap-test] = updated
(10)       [files] = noop
(10)       [pap] = noop
(10)     } # authorize = updated
(10)   Found Auth-Type = eap-test
(10)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(10)     authenticate {
(10) eap-test: Expiring EAP session with state 0x60424b7763404693
(10) eap-test: Finished EAP session with state 0x60424b7763404693
(10) eap-test: Previous EAP request found for state 0x60424b7763404693, released from the list
(10) eap-test: Peer sent packet with method EAP TLS (13)
(10) eap-test: Calling submodule eap_tls to process data
(10) eap_tls: (TLS) Peer ACKed our handshake fragment
(10) eap-test: Sending EAP Request (code 1) ID 3 length 931
(10) eap-test: EAP session adding &reply:State = 0x60424b7764414693
(10)       [eap-test] = handled
(10)     } # authenticate = handled
(10) } # server eap-test-inner
(10) Virtual server sending reply
(10)   EAP-Message = 0x010303a30dc000000c0898575875ef6443bdf45795076072f85d383b5d1361c21708691db27574b4c9d4c3523eb6470f4b975e2f2f2a8922f22fe054763911ec0e7f7da974aba3ffb31a4bf0275c56b5d0bebd8d86f150378c538eed4815f35c6e8b034ea817f0262eeec89c2bd13ee0928f19cf71b00a274214ca5a6a94a4d08519a2c5321232f940c86d3084f900f05df9a42c26e7d35c7b96cb78045fb52570ebda63165f114e4d2aea8dcbd97e764625f59c55e81845a36c6e8edfcdc34cbdb54f10edef85d22e6fe3cfd81f967ee70114259051fc4003d652094c64e47dc838616042eaddb1888d34bdb33f88575a1780971a485c0eaae40275e96ea6181bb3308b2192dcefa09acfded8f6c72e7061562ea80fdb6fc01548fa327a3c7955dd29aafa9d54d7f9573ba01838eeb7ffda279d6b97fe98b8aeb878bd3783e779ab3a1fd75f98c8d9387ae9c1cd5c727c736aaa0b3f3f271238fc74a8144138f0dc27d7caf5ebecc897b09d5834d65cef811bc8d5dc7f
(10)   Message-Authenticator = 0x00000000000000000000000000000000
(10)   State = 0x60424b7764414693892ee51c5dcdb9ee
(10) eap_peap: Got tunneled reply code 11
(10) eap_peap:   EAP-Message = 0x010303a30dc000000c0898575875ef6443bdf45795076072f85d383b5d1361c21708691db27574b4c9d4c3523eb6470f4b975e2f2f2a8922f22fe054763911ec0e7f7da974aba3ffb31a4bf0275c56b5d0bebd8d86f150378c538eed4815f35c6e8b034ea817f0262eeec89c2bd13ee0928f19cf71b00a274214ca5a6a94a4d08519a2c5321232f940c86d3084f900f05df9a42c26e7d35c7b96cb78045fb52570ebda63165f114e4d2aea8dcbd97e764625f59c55e81845a36c6e8edfcdc34cbdb54f10edef85d22e6fe3cfd81f967ee70114259051fc4003d652094c64e47dc838616042eaddb1888d34bdb33f88575a1780971a485c0eaae40275e96ea6181bb3308b2192dcefa09acfded8f6c72e7061562ea80fdb6fc01548fa327a3c7955dd29aafa9d54d7f9573ba01838eeb7ffda279d6b97fe98b8aeb878bd3783e779ab3a1fd75f98c8d9387ae9c1cd5c727c736aaa0b3f3f271238fc74a8144138f0dc27d7caf5ebecc897b09d5834d65cef811bc8d5dc7f
(10) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(10) eap_peap:   State = 0x60424b7764414693892ee51c5dcdb9ee
(10) eap_peap: Got tunneled reply RADIUS code 11
(10) eap_peap:   EAP-Message = 0x010303a30dc000000c0898575875ef6443bdf45795076072f85d383b5d1361c21708691db27574b4c9d4c3523eb6470f4b975e2f2f2a8922f22fe054763911ec0e7f7da974aba3ffb31a4bf0275c56b5d0bebd8d86f150378c538eed4815f35c6e8b034ea817f0262eeec89c2bd13ee0928f19cf71b00a274214ca5a6a94a4d08519a2c5321232f940c86d3084f900f05df9a42c26e7d35c7b96cb78045fb52570ebda63165f114e4d2aea8dcbd97e764625f59c55e81845a36c6e8edfcdc34cbdb54f10edef85d22e6fe3cfd81f967ee70114259051fc4003d652094c64e47dc838616042eaddb1888d34bdb33f88575a1780971a485c0eaae40275e96ea6181bb3308b2192dcefa09acfded8f6c72e7061562ea80fdb6fc01548fa327a3c7955dd29aafa9d54d7f9573ba01838eeb7ffda279d6b97fe98b8aeb878bd3783e779ab3a1fd75f98c8d9387ae9c1cd5c727c736aaa0b3f3f271238fc74a8144138f0dc27d7caf5ebecc897b09d5834d65cef811bc8d5dc7f
(10) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(10) eap_peap:   State = 0x60424b7764414693892ee51c5dcdb9ee
(10) eap_peap: Got tunneled Access-Challenge
(10) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(10) eap-test: Sending EAP Request (code 1) ID 3 length 955
(10) eap-test: EAP session adding &reply:State = 0xd423e3ffde20fa49
(10)     [eap-test] = handled
(10)   } # authenticate = handled
(10) Using Post-Auth-Type Challenge
(10) Post-Auth-Type sub-section not found.  Ignoring.
(10) session-state: Saving cached attributes
(10)   Framed-MTU = 984
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(10)   TLS-Session-Version = "TLS 1.3"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(10)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(10) Sent Access-Challenge Id 96 from 127.0.0.1:1812 to 127.0.0.1:50758 length 1019
(10)   EAP-Message = 0x010303bb190017030303b0e9c6d895c375c34eba0d1959adecf4679ce6207ba7e646d43703ab2c93a3acd012d79ae62be105f3238d41c9306788e363ae13120ec0bac01b4cebf5580a6aba0b13cd608160e6f15bbede7f6be279dcc41e47f9fa3f5184ca43777adb4787463f623caf99688a25d4ab205d9a439df3784b4c219ba70e8b8b9242fcf7fe7259db2ae8549f968d64a74dbc4cdbf6fda177d7757e272d59b3ded2777fbd486817e1ce26a9e358a8cd9c904191b00e721d2f4261d3c312cb42da241d93e5671aa5e3d876751d0ea2644c44609c0c2a59696d784d3bfca8bf3920232428e41ae9df7a97f47421df78bb2f8ec152c16f0c3bf29700385a262155ad297b91c0511b6f69fcb50383cb9bcfde66177e25d7c6b13f67917b99af19162220137448c868f950c15b2f0b730e1482abfbcf0cc958e76379c9fc7ad041becf3e5958361a88ae4373ceb986dfdae787c251240396931cfab664594cff000bea97a0e5006b2e111c895abcba109854cbb52355
(10)   Message-Authenticator = 0x00000000000000000000000000000000
(10)   State = 0xd423e3ffde20fa497564f89df5b41232
(10) Finished request
Waking up in 4.9 seconds.
(11) Received Access-Request Id 97 from 127.0.0.1:50758 to 127.0.0.1:1812 length 224
(11)   User-Name = "anonymous@example.org"
(11)   NAS-IP-Address = 127.0.0.1
(11)   NAS-Identifier = "hostapd"
(11)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(11)   NAS-Port-Type = Wireless-802.11
(11)   Service-Type = Framed-User
(11)   Calling-Station-Id = "52-54-00-12-34-57"
(11)   Connect-Info = "CONNECT 0Mbps 802.11b"
(11)   Acct-Session-Id = "9B5B1191159BC00E"
(11)   Framed-MTU = 1400
(11)   EAP-Message = 0x0203001e190017030300138f0099ef101271f6cd1c920e223c491be2826a
(11)   State = 0xd423e3ffde20fa497564f89df5b41232
(11)   Message-Authenticator = 0xefebee1fe8783b7c60af8883eecaf211
(11) Restoring &session-state
(11)   &session-state:Framed-MTU = 984
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(11)   &session-state:TLS-Session-Version = "TLS 1.3"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(11)   authorize {
(11)     if (User-Name == "bob") {
(11)     if (User-Name == "bob")  -> FALSE
(11)     [mschap] = noop
(11) eap-test: Peer sent EAP Response (code 2) ID 3 length 30
(11) eap-test: Continuing tunnel setup
(11)     [eap-test] = ok
(11)     [pap] = noop
(11)   } # authorize = ok
(11) Found Auth-Type = eap-test
(11) # Executing group from file /etc/freeradius/sites-enabled/test
(11)   authenticate {
(11) eap-test: Expiring EAP session with state 0x60424b7764414693
(11) eap-test: Finished EAP session with state 0xd423e3ffde20fa49
(11) eap-test: Previous EAP request found for state 0xd423e3ffde20fa49, released from the list
(11) eap-test: Peer sent packet with method EAP PEAP (25)
(11) eap-test: Calling submodule eap_peap to process data
(11) eap_peap: (TLS) EAP Done initial handshake
(11) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(11) eap_peap: Session established.  Decoding tunneled attributes
(11) eap_peap: PEAP state phase2
(11) eap_peap: EAP method TLS (13)
(11) eap_peap: Got tunneled request
(11) eap_peap:   EAP-Message = 0x020300060d00
(11) eap_peap: Setting User-Name to user@example.org
(11) eap_peap: Sending tunneled request to eap-test-inner
(11) eap_peap:   EAP-Message = 0x020300060d00
(11) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(11) eap_peap:   User-Name = "user@example.org"
(11) eap_peap:   State = 0x60424b7764414693892ee51c5dcdb9ee
(11) Virtual server eap-test-inner received request
(11)   EAP-Message = 0x020300060d00
(11)   FreeRADIUS-Proxied-To = 127.0.0.1
(11)   User-Name = "user@example.org"
(11)   State = 0x60424b7764414693892ee51c5dcdb9ee
(11) server eap-test-inner {
(11)   session-state: No cached attributes
(11)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(11)     authorize {
(11)       policy filter_username {
(11)         if (&User-Name) {
(11)         if (&User-Name)  -> TRUE
(11)         if (&User-Name)  {
(11)           if (&User-Name =~ / /) {
(11)           if (&User-Name =~ / /)  -> FALSE
(11)           if (&User-Name =~ /@[^@]*@/ ) {
(11)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(11)           if (&User-Name =~ /\.\./ ) {
(11)           if (&User-Name =~ /\.\./ )  -> FALSE
(11)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(11)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(11)           if (&User-Name =~ /\.$/)  {
(11)           if (&User-Name =~ /\.$/)   -> FALSE
(11)           if (&User-Name =~ /@\./)  {
(11)           if (&User-Name =~ /@\./)   -> FALSE
(11)         } # if (&User-Name)  = notfound
(11)       } # policy filter_username = notfound
(11)       if (User-Name == "bob") {
(11)       if (User-Name == "bob")  -> FALSE
(11)       [mschap] = noop
(11) suffix: Checking for suffix after "@"
(11) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(11) suffix: No such realm "example.org"
(11)       [suffix] = noop
(11)       update control {
(11)         &Proxy-To-Realm := LOCAL
(11)       } # update control = noop
(11) eap-test: Peer sent EAP Response (code 2) ID 3 length 6
(11) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(11)       [eap-test] = updated
(11)       [files] = noop
(11)       [pap] = noop
(11)     } # authorize = updated
(11)   Found Auth-Type = eap-test
(11)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(11)     authenticate {
(11) eap-test: Expiring EAP session with state 0x60424b7764414693
(11) eap-test: Finished EAP session with state 0x60424b7764414693
(11) eap-test: Previous EAP request found for state 0x60424b7764414693, released from the list
(11) eap-test: Peer sent packet with method EAP TLS (13)
(11) eap-test: Calling submodule eap_tls to process data
(11) eap_tls: (TLS) Peer ACKed our handshake fragment
(11) eap-test: Sending EAP Request (code 1) ID 4 length 327
(11) eap-test: EAP session adding &reply:State = 0x60424b7765464693
(11)       [eap-test] = handled
(11)     } # authenticate = handled
(11) } # server eap-test-inner
(11) Virtual server sending reply
(11)   EAP-Message = 0x010401470d8000000c087346692a2af9876c2467abae4b1fe0f74095f4d461880c0fd6bc491e66cda9f10e572b6a09b4d31f04044482e24115317f3b01c6b24cc139ba3cf2e7de177a92ee8de8a246b30882426a4fd436a880f96242baeeb05a0026668359c386fa64fe2695c88bae4882c27f34d38dee47624909d73d87bc168119b65a27f08718871e6d43706ce455620729a6ecfb578949a50569b2ef5c1ce5a24b44a7949a8b7f6a0389417148c06ba368a485d1fdf4ae798f82056158490d1c6e620dcf800ca9bd10332dec8ea300100af61d628169d9fdd3fa42bf7cc06666471b0180be1b4b29a9a1a2f29bfdae899cf5b35f98da0b064813f717030300459f0dc7112fa796aebfff45a3f4c55414a36cbe1d7aabcf2c1f6747d3e41b8b9ab9ed7314140144f49c7eee9f8bc125674e119d5049dc4b6192d8b21774fe1b7f3ccafd8d15
(11)   Message-Authenticator = 0x00000000000000000000000000000000
(11)   State = 0x60424b7765464693892ee51c5dcdb9ee
(11) eap_peap: Got tunneled reply code 11
(11) eap_peap:   EAP-Message = 0x010401470d8000000c087346692a2af9876c2467abae4b1fe0f74095f4d461880c0fd6bc491e66cda9f10e572b6a09b4d31f04044482e24115317f3b01c6b24cc139ba3cf2e7de177a92ee8de8a246b30882426a4fd436a880f96242baeeb05a0026668359c386fa64fe2695c88bae4882c27f34d38dee47624909d73d87bc168119b65a27f08718871e6d43706ce455620729a6ecfb578949a50569b2ef5c1ce5a24b44a7949a8b7f6a0389417148c06ba368a485d1fdf4ae798f82056158490d1c6e620dcf800ca9bd10332dec8ea300100af61d628169d9fdd3fa42bf7cc06666471b0180be1b4b29a9a1a2f29bfdae899cf5b35f98da0b064813f717030300459f0dc7112fa796aebfff45a3f4c55414a36cbe1d7aabcf2c1f6747d3e41b8b9ab9ed7314140144f49c7eee9f8bc125674e119d5049dc4b6192d8b21774fe1b7f3ccafd8d15
(11) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(11) eap_peap:   State = 0x60424b7765464693892ee51c5dcdb9ee
(11) eap_peap: Got tunneled reply RADIUS code 11
(11) eap_peap:   EAP-Message = 0x010401470d8000000c087346692a2af9876c2467abae4b1fe0f74095f4d461880c0fd6bc491e66cda9f10e572b6a09b4d31f04044482e24115317f3b01c6b24cc139ba3cf2e7de177a92ee8de8a246b30882426a4fd436a880f96242baeeb05a0026668359c386fa64fe2695c88bae4882c27f34d38dee47624909d73d87bc168119b65a27f08718871e6d43706ce455620729a6ecfb578949a50569b2ef5c1ce5a24b44a7949a8b7f6a0389417148c06ba368a485d1fdf4ae798f82056158490d1c6e620dcf800ca9bd10332dec8ea300100af61d628169d9fdd3fa42bf7cc06666471b0180be1b4b29a9a1a2f29bfdae899cf5b35f98da0b064813f717030300459f0dc7112fa796aebfff45a3f4c55414a36cbe1d7aabcf2c1f6747d3e41b8b9ab9ed7314140144f49c7eee9f8bc125674e119d5049dc4b6192d8b21774fe1b7f3ccafd8d15
(11) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(11) eap_peap:   State = 0x60424b7765464693892ee51c5dcdb9ee
(11) eap_peap: Got tunneled Access-Challenge
(11) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(11) eap-test: Sending EAP Request (code 1) ID 4 length 351
(11) eap-test: EAP session adding &reply:State = 0xd423e3ffdf27fa49
(11)     [eap-test] = handled
(11)   } # authenticate = handled
(11) Using Post-Auth-Type Challenge
(11) Post-Auth-Type sub-section not found.  Ignoring.
(11) session-state: Saving cached attributes
(11)   Framed-MTU = 984
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(11)   TLS-Session-Version = "TLS 1.3"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(11)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(11) Sent Access-Challenge Id 97 from 127.0.0.1:1812 to 127.0.0.1:50758 length 411
(11)   EAP-Message = 0x0104015f190017030301543e5bf3a58fdea40d317e4d20927f9681b1c859af196b554bb3b05edc8ce8f52f99b7222ec4f42be80afc34324dad384522796cbffa1302ab639a2575ebcf51687d39f789ff22910dbf86bf6c28a73333a193fd3463168980e86a88c74ccab448f43d217c4b76b0a3bad54b4c6774e0d4329da52817f2c4217c3653eee3e5b10fa084d2bfe772dfc61861deae906eea844d21dd139bd82f04408671271c0783aace8c97c2081f5351521aa4589db46888b935da2336ecc3c4ae9b769ca8a352dd59eaee0d9274f435e7031f66f747080d0e52f73bebc62c067e802c1fc92c410585f886972cfce23f13e9946882aa0ffac4cde56f62a83895c4d9e7732b137b44a120795383015b7282037f23b6b0f31b68ad6345dac8faecb49e42f14b23eca950a7baa61d47a903af58947435f38f668164ea23e36186fbc222f0273be42f072e6ea6630cd698cd583560f27dcc22bb5e7a3d4d
(11)   Message-Authenticator = 0x00000000000000000000000000000000
(11)   State = 0xd423e3ffdf27fa497564f89df5b41232
(11) Finished request
Waking up in 4.9 seconds.
(12) Received Access-Request Id 98 from 127.0.0.1:50758 to 127.0.0.1:1812 length 1520
(12)   User-Name = "anonymous@example.org"
(12)   NAS-IP-Address = 127.0.0.1
(12)   NAS-Identifier = "hostapd"
(12)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(12)   NAS-Port-Type = Wireless-802.11
(12)   Service-Type = Framed-User
(12)   Calling-Station-Id = "52-54-00-12-34-57"
(12)   Connect-Info = "CONNECT 0Mbps 802.11b"
(12)   Acct-Session-Id = "9B5B1191159BC00E"
(12)   Framed-MTU = 1400
(12)   EAP-Message = 0x0204052419001703030519452fbb4349fcb722f79ddc4018d93098d64e678acfc1ad570327ed11ebde893cb75135556e7bd58b35166c1bcbb0173d4410deb795a3415d0594328b1440fc44fb459bcd1a8f621604bc64b278008e1d9250685f93c117b5709e063b16d9d091de35b7a0261b59cd3cf64b55ec0709614dcbc0e8fe6048a65debb99eed8acb1c4438acf52717b5920df06cd9dac23dbe69a7d6d4d25dad6501dce03dd62f736d7b101a6846f8025c3f6abd956d4ba23e257a2b050a3e57b635961a89381fc1e8e59ac117267541ba8e861a43c0d0bad2c2cc78d55037f65a3973da6d471bfabab367eedfe9deacfc9dc430feb936e8b75cfcf6bdd6ee8b3d7346eea16cf988d342f6571173bb18916ef7a54d8b6d1632ac84ad169720ba780e84b0a809d7a99f2413ed81de8597afb4d24d0a00d1fed7ac9a03e11144ceac9bff71329783c5ef26346ce41bd07481acf751110df80e094cb8da4e106fc26fe1840ddef8aac42384f57940707ee9d337137357
(12)   State = 0xd423e3ffdf27fa497564f89df5b41232
(12)   Message-Authenticator = 0x452a22c4dad7f3d5b918445870ab8bc5
(12) Restoring &session-state
(12)   &session-state:Framed-MTU = 984
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(12)   &session-state:TLS-Session-Version = "TLS 1.3"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(12)   authorize {
(12)     if (User-Name == "bob") {
(12)     if (User-Name == "bob")  -> FALSE
(12)     [mschap] = noop
(12) eap-test: Peer sent EAP Response (code 2) ID 4 length 1316
(12) eap-test: Continuing tunnel setup
(12)     [eap-test] = ok
(12)     [pap] = noop
(12)   } # authorize = ok
(12) Found Auth-Type = eap-test
(12) # Executing group from file /etc/freeradius/sites-enabled/test
(12)   authenticate {
(12) eap-test: Expiring EAP session with state 0x60424b7765464693
(12) eap-test: Finished EAP session with state 0xd423e3ffdf27fa49
(12) eap-test: Previous EAP request found for state 0xd423e3ffdf27fa49, released from the list
(12) eap-test: Peer sent packet with method EAP PEAP (25)
(12) eap-test: Calling submodule eap_peap to process data
(12) eap_peap: (TLS) EAP Done initial handshake
(12) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(12) eap_peap: Session established.  Decoding tunneled attributes
(12) eap_peap: PEAP state phase2
(12) eap_peap: EAP method TLS (13)
(12) eap_peap: Got tunneled request
(12) eap_peap:   EAP-Message = 0x0204050c0dc000000538140303000101170303052d01e4975a4c5a639120202a29c23aed557d7843e2936283ac23cf0aa14778ee9e8a5b424cd7e699e04778b391a741d57723086bc28ece3616d0e74ba5a4732c9aa01a8c0f96c4b7d57c19da0eed174b17ab19806bfdf0c9c55be111f16e26d97fad9ca2dcc85837d334afd9ddfa43ce6c0d288478ec807ba5a4b72e301e9675b718e7c6f46360ca162ac03d6d0395dacd5531df191c8bd31ed7abdb3e213c62b4a9db577aad20881a2c19e8b18bb9b8f6ec651725d945be72c50519b07d7eb01ad9aea160817abcb45662f15a1079709a85880c5ee14da6263e24e3548c4c0263cda542e3830f0d70
(12) eap_peap:   EAP-Message = 0x3afcb5c0907c4995b3cbab31c0f3a4377ef74e18cc3351ab5817d1bc5b1fdfe775bdfb173c2508a244d68ccff40634b65886b93c3087b84a2b858732d0e8299f92c7706656f0341c217d6c3cbfdba38dc1d63eb09b3857643fb3955169865004e0a50cb33be7242a4167f09efcc67f565117510d722da7f0c7985ed39319596de7074b366dc72cb416468c5391baa25cdfc3b3c14a72959b6c0376071c3c05fd3e9d927fd4a01a9ce2acc53a0338e14fb401b48615f78aa99815c0550f10d4dc81862bdee6c3253b18c9c5ee31d33dd4979acb1b50b88447c1706320e7cc20fd67729ab9c7dd8c9ebadb15731c261e73bb298d8c841cdbd59ea4175f86db378e98c80e7fcba1e01ca30ba492030d1baf6aa771c4a348582ef252a334f5ccb47a7365ce04626591ec16e93bb0144ae694b31563d76b6697a5d6618b8280321ec563f841e971490ee43a48bb49afc77fae6cb06da93f0eb12928887ab43fd9b90ceb8bf64aaa2d463ce70af7d889dc72d73c405337080309
(12) eap_peap: Setting User-Name to user@example.org
(12) eap_peap: Sending tunneled request to eap-test-inner
(12) eap_peap:   EAP-Message = 0x0204050c0dc000000538140303000101170303052d01e4975a4c5a639120202a29c23aed557d7843e2936283ac23cf0aa14778ee9e8a5b424cd7e699e04778b391a741d57723086bc28ece3616d0e74ba5a4732c9aa01a8c0f96c4b7d57c19da0eed174b17ab19806bfdf0c9c55be111f16e26d97fad9ca2dcc85837d334afd9ddfa43ce6c0d288478ec807ba5a4b72e301e9675b718e7c6f46360ca162ac03d6d0395dacd5531df191c8bd31ed7abdb3e213c62b4a9db577aad20881a2c19e8b18bb9b8f6ec651725d945be72c50519b07d7eb01ad9aea160817abcb45662f15a1079709a85880c5ee14da6263e24e3548c4c0263cda542e3830f0d70
(12) eap_peap:   EAP-Message = 0x3afcb5c0907c4995b3cbab31c0f3a4377ef74e18cc3351ab5817d1bc5b1fdfe775bdfb173c2508a244d68ccff40634b65886b93c3087b84a2b858732d0e8299f92c7706656f0341c217d6c3cbfdba38dc1d63eb09b3857643fb3955169865004e0a50cb33be7242a4167f09efcc67f565117510d722da7f0c7985ed39319596de7074b366dc72cb416468c5391baa25cdfc3b3c14a72959b6c0376071c3c05fd3e9d927fd4a01a9ce2acc53a0338e14fb401b48615f78aa99815c0550f10d4dc81862bdee6c3253b18c9c5ee31d33dd4979acb1b50b88447c1706320e7cc20fd67729ab9c7dd8c9ebadb15731c261e73bb298d8c841cdbd59ea4175f86db378e98c80e7fcba1e01ca30ba492030d1baf6aa771c4a348582ef252a334f5ccb47a7365ce04626591ec16e93bb0144ae694b31563d76b6697a5d6618b8280321ec563f841e971490ee43a48bb49afc77fae6cb06da93f0eb12928887ab43fd9b90ceb8bf64aaa2d463ce70af7d889dc72d73c405337080309
(12) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(12) eap_peap:   User-Name = "user@example.org"
(12) eap_peap:   State = 0x60424b7765464693892ee51c5dcdb9ee
(12) Virtual server eap-test-inner received request
(12)   EAP-Message = 0x0204050c0dc000000538140303000101170303052d01e4975a4c5a639120202a29c23aed557d7843e2936283ac23cf0aa14778ee9e8a5b424cd7e699e04778b391a741d57723086bc28ece3616d0e74ba5a4732c9aa01a8c0f96c4b7d57c19da0eed174b17ab19806bfdf0c9c55be111f16e26d97fad9ca2dcc85837d334afd9ddfa43ce6c0d288478ec807ba5a4b72e301e9675b718e7c6f46360ca162ac03d6d0395dacd5531df191c8bd31ed7abdb3e213c62b4a9db577aad20881a2c19e8b18bb9b8f6ec651725d945be72c50519b07d7eb01ad9aea160817abcb45662f15a1079709a85880c5ee14da6263e24e3548c4c0263cda542e3830f0d70
(12)   EAP-Message = 0x3afcb5c0907c4995b3cbab31c0f3a4377ef74e18cc3351ab5817d1bc5b1fdfe775bdfb173c2508a244d68ccff40634b65886b93c3087b84a2b858732d0e8299f92c7706656f0341c217d6c3cbfdba38dc1d63eb09b3857643fb3955169865004e0a50cb33be7242a4167f09efcc67f565117510d722da7f0c7985ed39319596de7074b366dc72cb416468c5391baa25cdfc3b3c14a72959b6c0376071c3c05fd3e9d927fd4a01a9ce2acc53a0338e14fb401b48615f78aa99815c0550f10d4dc81862bdee6c3253b18c9c5ee31d33dd4979acb1b50b88447c1706320e7cc20fd67729ab9c7dd8c9ebadb15731c261e73bb298d8c841cdbd59ea4175f86db378e98c80e7fcba1e01ca30ba492030d1baf6aa771c4a348582ef252a334f5ccb47a7365ce04626591ec16e93bb0144ae694b31563d76b6697a5d6618b8280321ec563f841e971490ee43a48bb49afc77fae6cb06da93f0eb12928887ab43fd9b90ceb8bf64aaa2d463ce70af7d889dc72d73c405337080309
(12)   FreeRADIUS-Proxied-To = 127.0.0.1
(12)   User-Name = "user@example.org"
(12)   State = 0x60424b7765464693892ee51c5dcdb9ee
(12) server eap-test-inner {
(12)   session-state: No cached attributes
(12)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(12)     authorize {
(12)       policy filter_username {
(12)         if (&User-Name) {
(12)         if (&User-Name)  -> TRUE
(12)         if (&User-Name)  {
(12)           if (&User-Name =~ / /) {
(12)           if (&User-Name =~ / /)  -> FALSE
(12)           if (&User-Name =~ /@[^@]*@/ ) {
(12)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(12)           if (&User-Name =~ /\.\./ ) {
(12)           if (&User-Name =~ /\.\./ )  -> FALSE
(12)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(12)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(12)           if (&User-Name =~ /\.$/)  {
(12)           if (&User-Name =~ /\.$/)   -> FALSE
(12)           if (&User-Name =~ /@\./)  {
(12)           if (&User-Name =~ /@\./)   -> FALSE
(12)         } # if (&User-Name)  = notfound
(12)       } # policy filter_username = notfound
(12)       if (User-Name == "bob") {
(12)       if (User-Name == "bob")  -> FALSE
(12)       [mschap] = noop
(12) suffix: Checking for suffix after "@"
(12) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(12) suffix: No such realm "example.org"
(12)       [suffix] = noop
(12)       update control {
(12)         &Proxy-To-Realm := LOCAL
(12)       } # update control = noop
(12) eap-test: Peer sent EAP Response (code 2) ID 4 length 253
(12) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(12)       [eap-test] = updated
(12)       [files] = noop
(12)       [pap] = noop
(12)     } # authorize = updated
(12)   Found Auth-Type = eap-test
(12)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(12)     authenticate {
(12) eap-test: Expiring EAP session with state 0x60424b7765464693
(12) eap-test: Finished EAP session with state 0x60424b7765464693
(12) eap-test: Previous EAP request found for state 0x60424b7765464693, released from the list
(12) eap-test: Peer sent packet with method EAP TLS (13)
(12) eap-test: Calling submodule eap_tls to process data
(12) eap_tls: (TLS) EAP Peer says that the final record size will be 1336 bytes
(12) eap_tls: (TLS) EAP Expecting 2 fragments
(12) eap_tls: (TLS) EAP Got first TLS fragment (1282 bytes).  Peer says more fragments will follow
(12) eap_tls: (TLS) EAP ACKing fragment, the peer should send more data.
(12) eap-test: Sending EAP Request (code 1) ID 5 length 6
(12) eap-test: EAP session adding &reply:State = 0x60424b7766474693
(12)       [eap-test] = handled
(12)     } # authenticate = handled
(12) } # server eap-test-inner
(12) Virtual server sending reply
(12)   EAP-Message = 0x010500060d00
(12)   Message-Authenticator = 0x00000000000000000000000000000000
(12)   State = 0x60424b7766474693892ee51c5dcdb9ee
(12) eap_peap: Got tunneled reply code 11
(12) eap_peap:   EAP-Message = 0x010500060d00
(12) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(12) eap_peap:   State = 0x60424b7766474693892ee51c5dcdb9ee
(12) eap_peap: Got tunneled reply RADIUS code 11
(12) eap_peap:   EAP-Message = 0x010500060d00
(12) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(12) eap_peap:   State = 0x60424b7766474693892ee51c5dcdb9ee
(12) eap_peap: Got tunneled Access-Challenge
(12) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(12) eap-test: Sending EAP Request (code 1) ID 5 length 30
(12) eap-test: EAP session adding &reply:State = 0xd423e3ffd826fa49
(12)     [eap-test] = handled
(12)   } # authenticate = handled
(12) Using Post-Auth-Type Challenge
(12) Post-Auth-Type sub-section not found.  Ignoring.
(12) session-state: Saving cached attributes
(12)   Framed-MTU = 984
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(12)   TLS-Session-Version = "TLS 1.3"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(12)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(12) Sent Access-Challenge Id 98 from 127.0.0.1:1812 to 127.0.0.1:50758 length 88
(12)   EAP-Message = 0x0105001e1900170303001342d1d595e89fa320c9245a052f748b05ccfb16
(12)   Message-Authenticator = 0x00000000000000000000000000000000
(12)   State = 0xd423e3ffd826fa497564f89df5b41232
(12) Finished request
Waking up in 4.9 seconds.
(13) Received Access-Request Id 99 from 127.0.0.1:50758 to 127.0.0.1:1812 length 278
(13)   User-Name = "anonymous@example.org"
(13)   NAS-IP-Address = 127.0.0.1
(13)   NAS-Identifier = "hostapd"
(13)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(13)   NAS-Port-Type = Wireless-802.11
(13)   Service-Type = Framed-User
(13)   Calling-Station-Id = "52-54-00-12-34-57"
(13)   Connect-Info = "CONNECT 0Mbps 802.11b"
(13)   Acct-Session-Id = "9B5B1191159BC00E"
(13)   Framed-MTU = 1400
(13)   EAP-Message = 0x02050054190017030300494375cd0b909e2568a30106a19b99dac4972c485ee8dbdf26333167d3ab921ad6840c554b45444950cff1eacda990adea2fc66d1839dd16275c460b742b8be95943a54758f1905637f1
(13)   State = 0xd423e3ffd826fa497564f89df5b41232
(13)   Message-Authenticator = 0xd86cd564f7ae30c48aa78518b1cbf754
(13) Restoring &session-state
(13)   &session-state:Framed-MTU = 984
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(13)   &session-state:TLS-Session-Version = "TLS 1.3"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(13)   authorize {
(13)     if (User-Name == "bob") {
(13)     if (User-Name == "bob")  -> FALSE
(13)     [mschap] = noop
(13) eap-test: Peer sent EAP Response (code 2) ID 5 length 84
(13) eap-test: Continuing tunnel setup
(13)     [eap-test] = ok
(13)     [pap] = noop
(13)   } # authorize = ok
(13) Found Auth-Type = eap-test
(13) # Executing group from file /etc/freeradius/sites-enabled/test
(13)   authenticate {
(13) eap-test: Expiring EAP session with state 0x60424b7766474693
(13) eap-test: Finished EAP session with state 0xd423e3ffd826fa49
(13) eap-test: Previous EAP request found for state 0xd423e3ffd826fa49, released from the list
(13) eap-test: Peer sent packet with method EAP PEAP (25)
(13) eap-test: Calling submodule eap_peap to process data
(13) eap_peap: (TLS) EAP Done initial handshake
(13) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(13) eap_peap: Session established.  Decoding tunneled attributes
(13) eap_peap: PEAP state phase2
(13) eap_peap: EAP method TLS (13)
(13) eap_peap: Got tunneled request
(13) eap_peap:   EAP-Message = 0x0205003c0d0040648c8a17dbcdbd6c4e0a1734b76644feb93d636ff5d8150fae98ab73d389eae45e32a1f17670fd713d08552d80b1604aed4b4a8919
(13) eap_peap: Setting User-Name to user@example.org
(13) eap_peap: Sending tunneled request to eap-test-inner
(13) eap_peap:   EAP-Message = 0x0205003c0d0040648c8a17dbcdbd6c4e0a1734b76644feb93d636ff5d8150fae98ab73d389eae45e32a1f17670fd713d08552d80b1604aed4b4a8919
(13) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(13) eap_peap:   User-Name = "user@example.org"
(13) eap_peap:   State = 0x60424b7766474693892ee51c5dcdb9ee
(13) Virtual server eap-test-inner received request
(13)   EAP-Message = 0x0205003c0d0040648c8a17dbcdbd6c4e0a1734b76644feb93d636ff5d8150fae98ab73d389eae45e32a1f17670fd713d08552d80b1604aed4b4a8919
(13)   FreeRADIUS-Proxied-To = 127.0.0.1
(13)   User-Name = "user@example.org"
(13)   State = 0x60424b7766474693892ee51c5dcdb9ee
(13) server eap-test-inner {
(13)   session-state: No cached attributes
(13)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(13)     authorize {
(13)       policy filter_username {
(13)         if (&User-Name) {
(13)         if (&User-Name)  -> TRUE
(13)         if (&User-Name)  {
(13)           if (&User-Name =~ / /) {
(13)           if (&User-Name =~ / /)  -> FALSE
(13)           if (&User-Name =~ /@[^@]*@/ ) {
(13)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(13)           if (&User-Name =~ /\.\./ ) {
(13)           if (&User-Name =~ /\.\./ )  -> FALSE
(13)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(13)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(13)           if (&User-Name =~ /\.$/)  {
(13)           if (&User-Name =~ /\.$/)   -> FALSE
(13)           if (&User-Name =~ /@\./)  {
(13)           if (&User-Name =~ /@\./)   -> FALSE
(13)         } # if (&User-Name)  = notfound
(13)       } # policy filter_username = notfound
(13)       if (User-Name == "bob") {
(13)       if (User-Name == "bob")  -> FALSE
(13)       [mschap] = noop
(13) suffix: Checking for suffix after "@"
(13) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(13) suffix: No such realm "example.org"
(13)       [suffix] = noop
(13)       update control {
(13)         &Proxy-To-Realm := LOCAL
(13)       } # update control = noop
(13) eap-test: Peer sent EAP Response (code 2) ID 5 length 60
(13) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(13)       [eap-test] = updated
(13)       [files] = noop
(13)       [pap] = noop
(13)     } # authorize = updated
(13)   Found Auth-Type = eap-test
(13)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(13)     authenticate {
(13) eap-test: Expiring EAP session with state 0x60424b7766474693
(13) eap-test: Finished EAP session with state 0x60424b7766474693
(13) eap-test: Previous EAP request found for state 0x60424b7766474693, released from the list
(13) eap-test: Peer sent packet with method EAP TLS (13)
(13) eap-test: Calling submodule eap_tls to process data
(13) eap_tls: (TLS) EAP Got final fragment (54 bytes)
(13) eap_tls: (TLS) EAP Done initial handshake
(13) eap_tls: (TLS) Handshake state - Server TLSv1.3 early data
(13) eap_tls: (TLS) recv TLS 1.3 Handshake, Certificate
(13) eap_tls: (TLS) Creating attributes from server certificate
(13) eap_tls:   TLS-Cert-Serial := "0c07d58e78a29b7e96e7207429ed122616f3761a"
(13) eap_tls:   TLS-Cert-Expiration := "220125105813Z"
(13) eap_tls:   TLS-Cert-Valid-Since := "211126105813Z"
(13) eap_tls:   TLS-Cert-Subject := "/C=FR/ST=Radius/L=Somewhere/O=Example Inc./emailAddress=admin@example.org/CN=Example Certificate Authority"
(13) eap_tls:   TLS-Cert-Issuer := "/C=FR/ST=Radius/L=Somewhere/O=Example Inc./emailAddress=admin@example.org/CN=Example Certificate Authority"
(13) eap_tls:   TLS-Cert-Common-Name := "Example Certificate Authority"
(13) eap_tls: (TLS) Creating attributes from client certificate
(13) eap_tls:   TLS-Client-Cert-Serial := "02"
(13) eap_tls:   TLS-Client-Cert-Expiration := "220125105813Z"
(13) eap_tls:   TLS-Client-Cert-Valid-Since := "211126105813Z"
(13) eap_tls:   TLS-Client-Cert-Subject := "/C=FR/ST=Radius/O=Example Inc./CN=user@example.org/emailAddress=user@example.org"
(13) eap_tls:   TLS-Client-Cert-Issuer := "/C=FR/ST=Radius/L=Somewhere/O=Example Inc./emailAddress=admin@example.org/CN=Example Certificate Authority"
(13) eap_tls:   TLS-Client-Cert-Common-Name := "user@example.org"
(13) eap_tls:   TLS-Client-Cert-X509v3-Extended-Key-Usage += "TLS Web Client Authentication"
(13) eap_tls:   TLS-Client-Cert-X509v3-Extended-Key-Usage-OID += "1.3.6.1.5.5.7.3.2"
Certificate chain - 1 cert(s) untrusted
(TLS) untrusted certificate with depth [0] subject name /C=FR/ST=Radius/O=Example Inc./CN=user@example.org/emailAddress=user@example.org
(13) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read client certificate
(13) eap_tls: (TLS) recv TLS 1.3 Handshake, CertificateVerify
(13) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read certificate verify
(13) eap_tls: (TLS) recv TLS 1.3 Handshake, Finished
(13) eap_tls: (TLS) Handshake state - Server SSLv3/TLS read finished
(13) eap_tls: (TLS) Handshake state - SSL negotiation finished successfully
(13) eap_tls: (TLS) Connection Established
(13) eap_tls:   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(13) eap_tls:   TLS-Session-Version = "TLS 1.3"
(13) eap_tls: (TLS) Application data.
(13) eap_tls: (TLS) EAP Sending final Commitment Message.
(13) eap_tls: (TLS) send TLS 1.3 Handshake, Finished
(13) eap-test: Sending EAP Request (code 1) ID 6 length 33
(13) eap-test: EAP session adding &reply:State = 0x60424b7767444693
(13)       [eap-test] = handled
(13)     } # authenticate = handled
(13) } # server eap-test-inner
(13) Virtual server sending reply
(13)   EAP-Message = 0x010600210d80000000171703030012cd416fca9e5c641910a23ae27a488ef38f1b
(13)   Message-Authenticator = 0x00000000000000000000000000000000
(13)   State = 0x60424b7767444693892ee51c5dcdb9ee
(13) eap_peap: Got tunneled reply code 11
(13) eap_peap:   EAP-Message = 0x010600210d80000000171703030012cd416fca9e5c641910a23ae27a488ef38f1b
(13) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(13) eap_peap:   State = 0x60424b7767444693892ee51c5dcdb9ee
(13) eap_peap: Got tunneled reply RADIUS code 11
(13) eap_peap:   EAP-Message = 0x010600210d80000000171703030012cd416fca9e5c641910a23ae27a488ef38f1b
(13) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(13) eap_peap:   State = 0x60424b7767444693892ee51c5dcdb9ee
(13) eap_peap: Got tunneled Access-Challenge
(13) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(13) eap-test: Sending EAP Request (code 1) ID 6 length 57
(13) eap-test: EAP session adding &reply:State = 0xd423e3ffd925fa49
(13)     [eap-test] = handled
(13)   } # authenticate = handled
(13) Using Post-Auth-Type Challenge
(13) Post-Auth-Type sub-section not found.  Ignoring.
(13) session-state: Saving cached attributes
(13)   Framed-MTU = 984
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(13)   TLS-Session-Version = "TLS 1.3"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(13)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(13) Sent Access-Challenge Id 99 from 127.0.0.1:1812 to 127.0.0.1:50758 length 115
(13)   EAP-Message = 0x010600391900170303002eb49807aac55ace47c604b85de8324f6c2769228c1128ab8ddf6609cdfc980605f986ee99f40f9e34c116add12781
(13)   Message-Authenticator = 0x00000000000000000000000000000000
(13)   State = 0xd423e3ffd925fa497564f89df5b41232
(13) Finished request
Waking up in 4.9 seconds.
(14) Received Access-Request Id 100 from 127.0.0.1:50758 to 127.0.0.1:1812 length 224
(14)   User-Name = "anonymous@example.org"
(14)   NAS-IP-Address = 127.0.0.1
(14)   NAS-Identifier = "hostapd"
(14)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(14)   NAS-Port-Type = Wireless-802.11
(14)   Service-Type = Framed-User
(14)   Calling-Station-Id = "52-54-00-12-34-57"
(14)   Connect-Info = "CONNECT 0Mbps 802.11b"
(14)   Acct-Session-Id = "9B5B1191159BC00E"
(14)   Framed-MTU = 1400
(14)   EAP-Message = 0x0206001e19001703030013d653935f56bbf068c9893ffcc387b5b2859ebd
(14)   State = 0xd423e3ffd925fa497564f89df5b41232
(14)   Message-Authenticator = 0xda9730a1338d7d2d6930baf3ef4e0757
(14) Restoring &session-state
(14)   &session-state:Framed-MTU = 984
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(14)   &session-state:TLS-Session-Version = "TLS 1.3"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(14)   authorize {
(14)     if (User-Name == "bob") {
(14)     if (User-Name == "bob")  -> FALSE
(14)     [mschap] = noop
(14) eap-test: Peer sent EAP Response (code 2) ID 6 length 30
(14) eap-test: Continuing tunnel setup
(14)     [eap-test] = ok
(14)     [pap] = noop
(14)   } # authorize = ok
(14) Found Auth-Type = eap-test
(14) # Executing group from file /etc/freeradius/sites-enabled/test
(14)   authenticate {
(14) eap-test: Expiring EAP session with state 0x60424b7767444693
(14) eap-test: Finished EAP session with state 0xd423e3ffd925fa49
(14) eap-test: Previous EAP request found for state 0xd423e3ffd925fa49, released from the list
(14) eap-test: Peer sent packet with method EAP PEAP (25)
(14) eap-test: Calling submodule eap_peap to process data
(14) eap_peap: (TLS) EAP Done initial handshake
(14) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(14) eap_peap: Session established.  Decoding tunneled attributes
(14) eap_peap: PEAP state phase2
(14) eap_peap: EAP method TLS (13)
(14) eap_peap: Got tunneled request
(14) eap_peap:   EAP-Message = 0x020600060d00
(14) eap_peap: Setting User-Name to user@example.org
(14) eap_peap: Sending tunneled request to eap-test-inner
(14) eap_peap:   EAP-Message = 0x020600060d00
(14) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(14) eap_peap:   User-Name = "user@example.org"
(14) eap_peap:   State = 0x60424b7767444693892ee51c5dcdb9ee
(14) Virtual server eap-test-inner received request
(14)   EAP-Message = 0x020600060d00
(14)   FreeRADIUS-Proxied-To = 127.0.0.1
(14)   User-Name = "user@example.org"
(14)   State = 0x60424b7767444693892ee51c5dcdb9ee
(14) server eap-test-inner {
(14)   session-state: No cached attributes
(14)   # Executing section authorize from file /etc/freeradius/sites-enabled/eap-test-tunnel
(14)     authorize {
(14)       policy filter_username {
(14)         if (&User-Name) {
(14)         if (&User-Name)  -> TRUE
(14)         if (&User-Name)  {
(14)           if (&User-Name =~ / /) {
(14)           if (&User-Name =~ / /)  -> FALSE
(14)           if (&User-Name =~ /@[^@]*@/ ) {
(14)           if (&User-Name =~ /@[^@]*@/ )  -> FALSE
(14)           if (&User-Name =~ /\.\./ ) {
(14)           if (&User-Name =~ /\.\./ )  -> FALSE
(14)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(14)           if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(14)           if (&User-Name =~ /\.$/)  {
(14)           if (&User-Name =~ /\.$/)   -> FALSE
(14)           if (&User-Name =~ /@\./)  {
(14)           if (&User-Name =~ /@\./)   -> FALSE
(14)         } # if (&User-Name)  = notfound
(14)       } # policy filter_username = notfound
(14)       if (User-Name == "bob") {
(14)       if (User-Name == "bob")  -> FALSE
(14)       [mschap] = noop
(14) suffix: Checking for suffix after "@"
(14) suffix: Looking up realm "example.org" for User-Name = "user@example.org"
(14) suffix: No such realm "example.org"
(14)       [suffix] = noop
(14)       update control {
(14)         &Proxy-To-Realm := LOCAL
(14)       } # update control = noop
(14) eap-test: Peer sent EAP Response (code 2) ID 6 length 6
(14) eap-test: No EAP Start, assuming it's an on-going EAP conversation
(14)       [eap-test] = updated
(14)       [files] = noop
(14)       [pap] = noop
(14)     } # authorize = updated
(14)   Found Auth-Type = eap-test
(14)   # Executing group from file /etc/freeradius/sites-enabled/eap-test-tunnel
(14)     authenticate {
(14) eap-test: Expiring EAP session with state 0x60424b7767444693
(14) eap-test: Finished EAP session with state 0x60424b7767444693
(14) eap-test: Previous EAP request found for state 0x60424b7767444693, released from the list
(14) eap-test: Peer sent packet with method EAP TLS (13)
(14) eap-test: Calling submodule eap_tls to process data
(14) eap_tls: (TLS) Peer ACKed our handshake fragment.  handshake is finished
(14) eap-test: Sending EAP Success (code 3) ID 6 length 4
(14) eap-test: Freeing handler
(14)       [eap-test] = ok
(14)     } # authenticate = ok
(14)   # Executing section post-auth from file /etc/freeradius/sites-enabled/eap-test-tunnel
(14)     post-auth {
(14)       update reply {
(14)         &Tunnel-Private-Group-ID = "test"
(14)       } # update reply = noop
(14)     } # post-auth = noop
(14) } # server eap-test-inner
(14) Virtual server sending reply
(14)   MS-MPPE-Recv-Key = 0xd42efb0438d5ce51990223968ef9d967f4aaac3eca50e6db13ef9dd340294832
(14)   MS-MPPE-Send-Key = 0xe68ea867b92b637895923e47d68587392d01d20e6aa4a5f1d552702260cf5113
(14)   EAP-MSK = 0xd42efb0438d5ce51990223968ef9d967f4aaac3eca50e6db13ef9dd340294832e68ea867b92b637895923e47d68587392d01d20e6aa4a5f1d552702260cf5113
(14)   EAP-EMSK = 0x5d69b5a634f883bd492d6852601dac2a369c83b086fcc7d0540eba9ffc8234821a35f99910b25b140238065f936f14d975e120bef83f361b7c18a18fe64a3abf
(14)   EAP-Session-Id = 0x0d22dd9004416db76e90228bc88f3af57e21061cf5fe4fcb60ca884f5d1435371c8868651a447ed4a45d44a0e6541b19b7d37b76c6d2d8970f5f065d15081e6791
(14)   EAP-Message = 0x03060004
(14)   Message-Authenticator = 0x00000000000000000000000000000000
(14)   User-Name = "user@example.org"
(14)   Tunnel-Private-Group-Id = "test"
(14) eap_peap: Got tunneled reply code 2
(14) eap_peap:   MS-MPPE-Recv-Key = 0xd42efb0438d5ce51990223968ef9d967f4aaac3eca50e6db13ef9dd340294832
(14) eap_peap:   MS-MPPE-Send-Key = 0xe68ea867b92b637895923e47d68587392d01d20e6aa4a5f1d552702260cf5113
(14) eap_peap:   EAP-MSK = 0xd42efb0438d5ce51990223968ef9d967f4aaac3eca50e6db13ef9dd340294832e68ea867b92b637895923e47d68587392d01d20e6aa4a5f1d552702260cf5113
(14) eap_peap:   EAP-EMSK = 0x5d69b5a634f883bd492d6852601dac2a369c83b086fcc7d0540eba9ffc8234821a35f99910b25b140238065f936f14d975e120bef83f361b7c18a18fe64a3abf
(14) eap_peap:   EAP-Session-Id = 0x0d22dd9004416db76e90228bc88f3af57e21061cf5fe4fcb60ca884f5d1435371c8868651a447ed4a45d44a0e6541b19b7d37b76c6d2d8970f5f065d15081e6791
(14) eap_peap:   EAP-Message = 0x03060004
(14) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(14) eap_peap:   User-Name = "user@example.org"
(14) eap_peap:   Tunnel-Private-Group-Id = "test"
(14) eap_peap: Got tunneled reply RADIUS code 2
(14) eap_peap:   MS-MPPE-Recv-Key = 0xd42efb0438d5ce51990223968ef9d967f4aaac3eca50e6db13ef9dd340294832
(14) eap_peap:   MS-MPPE-Send-Key = 0xe68ea867b92b637895923e47d68587392d01d20e6aa4a5f1d552702260cf5113
(14) eap_peap:   EAP-MSK = 0xd42efb0438d5ce51990223968ef9d967f4aaac3eca50e6db13ef9dd340294832e68ea867b92b637895923e47d68587392d01d20e6aa4a5f1d552702260cf5113
(14) eap_peap:   EAP-EMSK = 0x5d69b5a634f883bd492d6852601dac2a369c83b086fcc7d0540eba9ffc8234821a35f99910b25b140238065f936f14d975e120bef83f361b7c18a18fe64a3abf
(14) eap_peap:   EAP-Session-Id = 0x0d22dd9004416db76e90228bc88f3af57e21061cf5fe4fcb60ca884f5d1435371c8868651a447ed4a45d44a0e6541b19b7d37b76c6d2d8970f5f065d15081e6791
(14) eap_peap:   EAP-Message = 0x03060004
(14) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(14) eap_peap:   User-Name = "user@example.org"
(14) eap_peap:   Tunnel-Private-Group-Id = "test"
(14) eap_peap: Tunneled authentication was successful
(14) eap_peap: SUCCESS
(14) eap_peap: (TLS) send TLS 1.3 Handshake, Finished
(14) eap_peap: Saving tunneled attributes for later
(14) eap-test: Sending EAP Request (code 1) ID 7 length 39
(14) eap-test: EAP session adding &reply:State = 0xd423e3ffda24fa49
(14)     [eap-test] = handled
(14)   } # authenticate = handled
(14) Using Post-Auth-Type Challenge
(14) Post-Auth-Type sub-section not found.  Ignoring.
(14) session-state: Saving cached attributes
(14)   Framed-MTU = 984
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(14)   TLS-Session-Version = "TLS 1.3"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(14)   TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(14) Sent Access-Challenge Id 100 from 127.0.0.1:1812 to 127.0.0.1:50758 length 97
(14)   EAP-Message = 0x010700271900170303001c343ac28cea01f7edfe3f3834aa3b302b3f7ae61590904317c242f848
(14)   Message-Authenticator = 0x00000000000000000000000000000000
(14)   State = 0xd423e3ffda24fa497564f89df5b41232
(14) Finished request
Waking up in 4.9 seconds.
(15) Received Access-Request Id 101 from 127.0.0.1:50758 to 127.0.0.1:1812 length 233
(15)   User-Name = "anonymous@example.org"
(15)   NAS-IP-Address = 127.0.0.1
(15)   NAS-Identifier = "hostapd"
(15)   Called-Station-Id = "36-B9-21-FD-35-3F:"
(15)   NAS-Port-Type = Wireless-802.11
(15)   Service-Type = Framed-User
(15)   Calling-Station-Id = "52-54-00-12-34-57"
(15)   Connect-Info = "CONNECT 0Mbps 802.11b"
(15)   Acct-Session-Id = "9B5B1191159BC00E"
(15)   Framed-MTU = 1400
(15)   EAP-Message = 0x020700271900170303001c384c64c4f91658b7386b0ce28639434846e20a42b9f86edf2d42644a
(15)   State = 0xd423e3ffda24fa497564f89df5b41232
(15)   Message-Authenticator = 0x98bbcf5cb5f4e41cdc1ac05f5c2e4beb
(15) Restoring &session-state
(15)   &session-state:Framed-MTU = 984
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, ClientHello"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, ServerHello"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 ChangeCipherSpec"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, EncryptedExtensions"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Certificate"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, CertificateVerify"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Cipher-Suite = "TLS_AES_256_GCM_SHA384"
(15)   &session-state:TLS-Session-Version = "TLS 1.3"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) recv TLS 1.3 Handshake, Finished"
(15)   &session-state:TLS-Session-Information = "(TLS) send TLS 1.3 Handshake, Finished"
(15) # Executing section authorize from file /etc/freeradius/sites-enabled/test
(15)   authorize {
(15)     if (User-Name == "bob") {
(15)     if (User-Name == "bob")  -> FALSE
(15)     [mschap] = noop
(15) eap-test: Peer sent EAP Response (code 2) ID 7 length 39
(15) eap-test: Continuing tunnel setup
(15)     [eap-test] = ok
(15)     [pap] = noop
(15)   } # authorize = ok
(15) Found Auth-Type = eap-test
(15) # Executing group from file /etc/freeradius/sites-enabled/test
(15)   authenticate {
(15) eap-test: Expiring EAP session with state 0xd423e3ffda24fa49
(15) eap-test: Finished EAP session with state 0xd423e3ffda24fa49
(15) eap-test: Previous EAP request found for state 0xd423e3ffda24fa49, released from the list
(15) eap-test: Peer sent packet with method EAP PEAP (25)
(15) eap-test: Calling submodule eap_peap to process data
(15) eap_peap: (TLS) EAP Done initial handshake
(15) eap_peap: (TLS) recv TLS 1.3 Handshake, Finished
(15) eap_peap: Session established.  Decoding tunneled attributes
(15) eap_peap: PEAP state send tlv success
(15) eap_peap: Received EAP-TLV response
(15) eap_peap: Success
(15) eap_peap: Using saved attributes from the original Access-Accept
(15) eap_peap:   EAP-MSK = 0xd42efb0438d5ce51990223968ef9d967f4aaac3eca50e6db13ef9dd340294832e68ea867b92b637895923e47d68587392d01d20e6aa4a5f1d552702260cf5113
(15) eap_peap:   EAP-EMSK = 0x5d69b5a634f883bd492d6852601dac2a369c83b086fcc7d0540eba9ffc8234821a35f99910b25b140238065f936f14d975e120bef83f361b7c18a18fe64a3abf
(15) eap_peap:   EAP-Session-Id = 0x0d22dd9004416db76e90228bc88f3af57e21061cf5fe4fcb60ca884f5d1435371c8868651a447ed4a45d44a0e6541b19b7d37b76c6d2d8970f5f065d15081e6791
(15) eap_peap:   User-Name = "user@example.org"
(15) eap_peap:   Tunnel-Private-Group-Id = "test"
(15) eap-test: Sending EAP Success (code 3) ID 7 length 4
(15) eap-test: Freeing handler
(15)     [eap-test] = ok
(15)   } # authenticate = ok
(15) Sent Access-Accept Id 101 from 127.0.0.1:1812 to 127.0.0.1:50758 length 184
(15)   User-Name = "user@example.org"
(15)   Tunnel-Private-Group-Id = "test"
(15)   MS-MPPE-Recv-Key = 0xe0438ad487d286431766208884d4dda40b5807cdc71e25b2979c97fbcdee99b3
(15)   MS-MPPE-Send-Key = 0x75fde7a1417369025029bf2a5758948d828014f9c66dbed29233485a5050d2c3
(15)   EAP-Message = 0x03070004
(15)   Message-Authenticator = 0x00000000000000000000000000000000
(15) Finished request
Waking up in 4.9 seconds.
(0) Cleaning up request packet ID 86 with timestamp +5 due to cleanup_delay was reached
(1) Cleaning up request packet ID 87 with timestamp +5 due to cleanup_delay was reached
(2) Cleaning up request packet ID 88 with timestamp +5 due to cleanup_delay was reached
(3) Cleaning up request packet ID 89 with timestamp +5 due to cleanup_delay was reached
(4) Cleaning up request packet ID 90 with timestamp +5 due to cleanup_delay was reached
(5) Cleaning up request packet ID 91 with timestamp +5 due to cleanup_delay was reached
(6) Cleaning up request packet ID 92 with timestamp +5 due to cleanup_delay was reached
(7) Cleaning up request packet ID 93 with timestamp +5 due to cleanup_delay was reached
(8) Cleaning up request packet ID 94 with timestamp +5 due to cleanup_delay was reached
(9) Cleaning up request packet ID 95 with timestamp +5 due to cleanup_delay was reached
(10) Cleaning up request packet ID 96 with timestamp +5 due to cleanup_delay was reached
(11) Cleaning up request packet ID 97 with timestamp +5 due to cleanup_delay was reached
(12) Cleaning up request packet ID 98 with timestamp +5 due to cleanup_delay was reached
(13) Cleaning up request packet ID 99 with timestamp +5 due to cleanup_delay was reached
(14) Cleaning up request packet ID 100 with timestamp +5 due to cleanup_delay was reached
(15) Cleaning up request packet ID 101 with timestamp +5 due to cleanup_delay was reached
Ready to process requests
